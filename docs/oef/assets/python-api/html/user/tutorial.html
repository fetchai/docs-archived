

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>First OEF Agents &mdash; oef 0.2.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="https://unpkg.com/mermaid@7.1.0/dist/mermaid.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Defining Data Models" href="defining-data-model.html" />
    <link rel="prev" title="Set up an OEF Node" href="oef-node.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> oef
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="oef-node.html">Set up an OEF Node</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">First OEF Agents</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#initialization">Initialization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup-an-oef-node">Setup an OEF Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-set-up-the-logger">Optional: set up the logger</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#first-example-echo-agent">First example: Echo agent</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#echo-agent-service">Echo Agent service</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#connect-to-the-oef">Connect to the OEF</a></li>
<li class="toctree-l4"><a class="reference internal" href="#define-a-data-model-and-a-description">Define a Data Model and a Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#register-the-service">Register the service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-the-agent">Run the agent</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#echo-agent-client">Echo Agent client</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Connect to the OEF</a></li>
<li class="toctree-l4"><a class="reference internal" href="#make-a-query">Make a query</a></li>
<li class="toctree-l4"><a class="reference internal" href="#search-for-services">Search for services</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wait-for-search-results">Wait for search results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#message-exchange">Message Exchange</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#second-example-weather-station">Second example: Weather Station</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#weather-station-agent">Weather Station Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#define-a-datamodel">Define a DataModel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#define-a-description">Define a Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#define-the-weatherstation-agent">Define the WeatherStation agent</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#weather-client-agent">Weather Client Agent</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Message Exchange</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="defining-data-model.html">Defining Data Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="query-language.html">The Query Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="communication-protocols.html">Communication Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced-topics.html">Using <cite>async</cite> APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oef.html">oef package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">oef</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>First OEF Agents</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user/tutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="first-oef-agents">
<span id="tutorial"></span><h1>First OEF Agents<a class="headerlink" href="#first-oef-agents" title="Permalink to this headline">¶</a></h1>
<p>In this guide, we show you some examples of how to develop and run OEF agents.</p>
<div class="section" id="initialization">
<h2>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h2>
<div class="section" id="setup-an-oef-node">
<h3>Setup an OEF Node<a class="headerlink" href="#setup-an-oef-node" title="Permalink to this headline">¶</a></h3>
<p>To be able to follow the following examples, we need to set up an OEF Node.
This node will manage the discovery of agents
and the communications between agents.</p>
<p>Please follow the instruction in this page about how to run an OEF Node: <a class="reference internal" href="oef-node.html#oef-node"><span class="std std-ref">Set up an OEF Node</span></a>.</p>
</div>
<div class="section" id="optional-set-up-the-logger">
<h3>Optional: set up the logger<a class="headerlink" href="#optional-set-up-the-logger" title="Permalink to this headline">¶</a></h3>
<p>It might be useful to see logging messages to better understand what happens behind the scenes.</p>
<p>To do so, run the following instructions at the beginning of your scripts:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">oef.logger</span> <span class="kn">import</span> <span class="n">set_logger</span>
<span class="n">set_logger</span><span class="p">(</span><span class="s2">&quot;oef.agents&quot;</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="first-example-echo-agent">
<h2>First example: Echo agent<a class="headerlink" href="#first-example-echo-agent" title="Permalink to this headline">¶</a></h2>
<p>In this section, we will develop an <cite>echo agent</cite>. That is, whenever it receives a message from another agent, it replies
with the same message.</p>
<p>First, we define the service agent that implements the echo service.
Then, we implement other client agents to interact with the echo service.</p>
<p>The code for the example can be found at this
<a class="reference external" href="https://github.com/fetchai/oef-sdk-python/tree/master/examples/echo">link</a>.</p>
<div class="section" id="echo-agent-service">
<h3>Echo Agent service<a class="headerlink" href="#echo-agent-service" title="Permalink to this headline">¶</a></h3>
<p>Let’s start to implement the echo service agent.
To do so, we define a new class, <code class="docutils literal notranslate"><span class="pre">EchoServiceAgent</span></code>, which extends
the <code class="docutils literal notranslate"><span class="pre">OEFAgent</span></code> class and redefines the behaviour of the <a class="reference internal" href="../oef.html#oef.agents.Agent.on_message" title="oef.agents.Agent.on_message"><code class="xref py py-func docutils literal notranslate"><span class="pre">on_message()</span></code></a> method.</p>
<p>The <a class="reference internal" href="../oef.html#oef.agents.Agent.on_message" title="oef.agents.Agent.on_message"><code class="xref py py-func docutils literal notranslate"><span class="pre">on_message()</span></code></a> method of an agent is called whenever
the agent is one of the intended recipients of the message.
In this case, we just send the message back
to the sender through the OEF.</p>
<p>In later examples, we will see a more complex protocol and
how to implement the associated callbacks.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oef.agents</span> <span class="kn">import</span> <span class="n">OEFAgent</span>

<span class="k">class</span> <span class="nc">EchoServiceAgent</span><span class="p">(</span><span class="n">OEFAgent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class that defines the behaviour of the echo service agent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">origin</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: Received message: msg_id={}, dialogue_id={}, origin={}, content={}&quot;</span>
              <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">msg_id</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">content</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: Sending {} back to {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">origin</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="connect-to-the-oef">
<h4>Connect to the OEF<a class="headerlink" href="#connect-to-the-oef" title="Permalink to this headline">¶</a></h4>
<p>In order to connect a (service) agent to the OEF, we need to specify:</p>
<ul class="simple">
<li><p>A unique identifier for the agent;</p></li>
<li><p>The IP address and port of the OEF Node on which we want to register;</p></li>
</ul>
<p>We will use <code class="docutils literal notranslate"><span class="pre">echo_server</span></code> as the identifier.
Choose the IP address and port pair provided by the OEFNode instance.
In this example, the IP address and the port pair will be
<code class="docutils literal notranslate"><span class="pre">127.0.0.1</span></code> and <code class="docutils literal notranslate"><span class="pre">3333</span></code>, respectively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create agent and connect it to OEF</span>
<span class="n">server_agent</span> <span class="o">=</span> <span class="n">EchoServiceAgent</span><span class="p">(</span><span class="s2">&quot;echo_server&quot;</span><span class="p">,</span> <span class="n">oef_addr</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">oef_port</span><span class="o">=</span><span class="mi">3333</span><span class="p">)</span>
<span class="n">server_agent</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="define-a-data-model-and-a-description">
<h4>Define a Data Model and a Description<a class="headerlink" href="#define-a-data-model-and-a-description" title="Permalink to this headline">¶</a></h4>
<p>In order to make our agent discoverable to other agents, we need to define a <cite>description</cite> (an instance of a schema),
which refers to a <cite>data model</cite> (abstract definition of the schema).
In this way, other agents can find our service by making <cite>queries</cite> (defined over the same data model) to the OEF.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oef.schema</span> <span class="kn">import</span> <span class="n">DataModel</span><span class="p">,</span> <span class="n">Description</span><span class="p">,</span> <span class="n">AttributeSchema</span>
<span class="n">echo_feature</span> <span class="o">=</span> <span class="n">AttributeSchema</span><span class="p">(</span><span class="s2">&quot;does_echo&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;Whether the service agent can do echo or not.&quot;</span><span class="p">)</span>
<span class="n">echo_model</span> <span class="o">=</span> <span class="n">DataModel</span><span class="p">(</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">echo_feature</span><span class="p">],</span> <span class="s2">&quot;echo data service.&quot;</span><span class="p">)</span>
<span class="n">echo_description</span> <span class="o">=</span> <span class="n">Description</span><span class="p">({</span><span class="s2">&quot;does_echo&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">},</span> <span class="n">echo_model</span><span class="p">)</span>
</pre></div>
</div>
<p>Our data model <code class="docutils literal notranslate"><span class="pre">echo_model</span></code> is very straightforward. It has only one boolean attribute, <cite>“does_echo”</cite>,
that specify if a service can answer to an echo request.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">echo_description</span></code> is the instantiation of our abstract
data model <code class="docutils literal notranslate"><span class="pre">echo</span></code> and defined accordingly. Since our service provides the echo service, we set the <code class="docutils literal notranslate"><span class="pre">&quot;does_echo&quot;</span></code>
field to <code class="docutils literal notranslate"><span class="pre">True</span></code> such that it will be discoverable by other agents.</p>
<p>For further details, please look at the documentation of <a class="reference internal" href="../oef.html#oef.schema.AttributeSchema" title="oef.schema.AttributeSchema"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttributeSchema</span></code></a>,
<a class="reference internal" href="../oef.html#oef.schema.DataModel" title="oef.schema.DataModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataModel</span></code></a> and <a class="reference internal" href="../oef.html#oef.schema.Description" title="oef.schema.Description"><code class="xref py py-class docutils literal notranslate"><span class="pre">Description</span></code></a>.</p>
</div>
<div class="section" id="register-the-service">
<h4>Register the service<a class="headerlink" href="#register-the-service" title="Permalink to this headline">¶</a></h4>
<p>Now that we have a description of our service, let’s register our service agent to the OEF, by using
<a class="reference internal" href="../oef.html#oef.agents.Agent.register_service" title="oef.agents.Agent.register_service"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_service()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">msg_id</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">server_agent</span><span class="o">.</span><span class="n">register_service</span><span class="p">(</span><span class="n">msg_id</span><span class="p">,</span> <span class="n">echo_description</span><span class="p">)</span>
</pre></div>
</div>
<p>This instruction will notify the OEF Node that there is a new service available. The message id <code class="docutils literal notranslate"><span class="pre">msg_id</span></code>
parameter will be used by the OEF Node to reference that request if something goes badly.</p>
<p>When another agent makes a query on the <code class="docutils literal notranslate"><span class="pre">echo_model</span></code>, if the <code class="docutils literal notranslate"><span class="pre">echo_description</span></code>
satisfies the constraint of the query’s constraints, then our agent will be one of the results.</p>
</div>
<div class="section" id="run-the-agent">
<h4>Run the agent<a class="headerlink" href="#run-the-agent" title="Permalink to this headline">¶</a></h4>
<p>To run the agent waiting for messages:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: Waiting for messages...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">server_agent</span><span class="o">.</span><span class="n">public_key</span><span class="p">))</span>
    <span class="n">server_agent</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: Disconnecting...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">server_agent</span><span class="o">.</span><span class="n">public_key</span><span class="p">))</span>
    <span class="n">server_agent</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">server_agent</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../oef.html#oef.agents.Agent.run" title="oef.agents.Agent.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a> method is blocking, so you have to switch to another terminal/console to launch the client.</p>
<p>For some particular use cases,
you may want to use <a class="reference internal" href="../oef.html#oef.agents.Agent.async_run" title="oef.agents.Agent.async_run"><code class="xref py py-func docutils literal notranslate"><span class="pre">async_run()</span></code></a>, which is the associated <code class="docutils literal notranslate"><span class="pre">async</span></code> method.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">finally</span></code> clause, we call the <a class="reference internal" href="../oef.html#oef.agents.Agent.stop" title="oef.agents.Agent.stop"><code class="xref py py-func docutils literal notranslate"><span class="pre">stop()</span></code></a> method to be sure that our agent has no
pending work to do.</p>
<p>Then, we disconnect the agent from the OEF Node.
It is a good practice to explicitly disconnect the agent after the work is done.
The <a class="reference internal" href="../oef.html#oef.agents.Agent.disconnect" title="oef.agents.Agent.disconnect"><code class="xref py py-func docutils literal notranslate"><span class="pre">disconnect()</span></code></a> method explicitly closes the connection with the OEF Node.</p>
</div>
</div>
<div class="section" id="echo-agent-client">
<h3>Echo Agent client<a class="headerlink" href="#echo-agent-client" title="Permalink to this headline">¶</a></h3>
<p>The <cite>EchoClientAgent</cite> implements our <cite>echo client</cite>, which is
the consumer of the service we implemented in the previous section.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">from</span> <span class="nn">oef.agents</span> <span class="kn">import</span> <span class="n">OEFAgent</span>

<span class="k">class</span> <span class="nc">EchoClientAgent</span><span class="p">(</span><span class="n">OEFAgent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class that defines the behaviour of the echo client agent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">origin</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: Received message: msg_id={}, dialogue_id={}, origin={}, content={}&quot;</span>
              <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">msg_id</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">content</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: Stopping...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_search_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">agents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">agents</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: search_id={}. Agents found: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">search_id</span><span class="p">,</span> <span class="n">agents</span><span class="p">))</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;hello&quot;</span>
            <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: Sending {} to {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">agent</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">agent</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: No agent found. Stopping...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../oef.html#oef.agents.Agent.on_message" title="oef.agents.Agent.on_message"><code class="xref py py-func docutils literal notranslate"><span class="pre">on_message()</span></code></a> method has the same semantics as the one implemented
in the <code class="docutils literal notranslate"><span class="pre">EchoServiceAgent</span></code> class. In this case,
we don’t implement any complex behaviour (we just print the received message).</p>
<p>The <a class="reference internal" href="../oef.html#oef.agents.Agent.on_search_result" title="oef.agents.Agent.on_search_result"><code class="xref py py-func docutils literal notranslate"><span class="pre">on_search_result()</span></code></a> callback is called whenever the agent receives
a search result of a search query with
<a class="reference internal" href="../oef.html#oef.agents.Agent.search_agents" title="oef.agents.Agent.search_agents"><code class="xref py py-func docutils literal notranslate"><span class="pre">search_agents()</span></code></a> or <a class="reference internal" href="../oef.html#oef.agents.Agent.search_services" title="oef.agents.Agent.search_services"><code class="xref py py-func docutils literal notranslate"><span class="pre">search_services()</span></code></a> methods.</p>
<p>In our case, the agent just sends a <code class="docutils literal notranslate"><span class="pre">&quot;hello&quot;</span></code> message (in bytes) to every discovered service,
by using the <a class="reference internal" href="../oef.html#oef.agents.Agent.send_message" title="oef.agents.Agent.send_message"><code class="xref py py-func docutils literal notranslate"><span class="pre">send_message()</span></code></a>  method.</p>
<div class="section" id="id1">
<h4>Connect to the OEF<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Analogously to the previous section, we connect our client to the OEF.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">client_agent</span> <span class="o">=</span> <span class="n">EchoClientAgent</span><span class="p">(</span><span class="s2">&quot;echo_client&quot;</span><span class="p">,</span> <span class="n">oef_addr</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">oef_port</span><span class="o">=</span><span class="mi">3333</span><span class="p">)</span>
<span class="n">client_agent</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="make-a-query">
<h4>Make a query<a class="headerlink" href="#make-a-query" title="Permalink to this headline">¶</a></h4>
<p>Now we need to search for agents who provide the <code class="docutils literal notranslate"><span class="pre">echo</span></code> service.</p>
<p>To do so, we create a <a class="reference internal" href="../oef.html#oef.query.Query" title="oef.query.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> referring to the <code class="docutils literal notranslate"><span class="pre">echo</span></code> data model. The first parameter is a list
of <em>constraints</em> over the attributes of the data model. However, since our data model is trivial,
our query just returns all the agents that are registered with the <code class="docutils literal notranslate"><span class="pre">echo</span></code> data model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a query for the echo data model</span>
<span class="kn">from</span> <span class="nn">oef.schema</span> <span class="kn">import</span> <span class="n">DataModel</span><span class="p">,</span> <span class="n">AttributeSchema</span>
<span class="kn">from</span> <span class="nn">oef.query</span> <span class="kn">import</span> <span class="n">Query</span><span class="p">,</span> <span class="n">Constraint</span><span class="p">,</span> <span class="n">Eq</span>
<span class="n">echo_feature</span> <span class="o">=</span> <span class="n">AttributeSchema</span><span class="p">(</span><span class="s2">&quot;does_echo&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;Whether the service agent can do echo.&quot;</span><span class="p">)</span>
<span class="n">echo_model</span> <span class="o">=</span> <span class="n">DataModel</span><span class="p">(</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">echo_feature</span><span class="p">],</span> <span class="s2">&quot;echo service.&quot;</span><span class="p">)</span>
<span class="n">echo_query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">([</span><span class="n">Constraint</span><span class="p">(</span><span class="s2">&quot;does_echo&quot;</span><span class="p">,</span> <span class="n">Eq</span><span class="p">(</span><span class="bp">True</span><span class="p">))],</span> <span class="n">echo_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="search-for-services">
<h4>Search for services<a class="headerlink" href="#search-for-services" title="Permalink to this headline">¶</a></h4>
<p>Once we have a query, we can ask the OEF to return
all service agents that satisfy the given constraints.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: Make search to the OEF&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">client_agent</span><span class="o">.</span><span class="n">public_key</span><span class="p">))</span>
<span class="n">client_agent</span><span class="o">.</span><span class="n">search_services</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">echo_query</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="wait-for-search-results">
<h4>Wait for search results<a class="headerlink" href="#wait-for-search-results" title="Permalink to this headline">¶</a></h4>
<p>The client agent needs to wait for search results from the OEF Node:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># wait for events</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">client_agent</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: Disconnecting...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">client_agent</span><span class="o">.</span><span class="n">public_key</span><span class="p">))</span>
    <span class="n">client_agent</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">client_agent</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</pre></div>
</div>
<p>The clean up of the allocated resources is analogous to the one shown before for the <code class="docutils literal notranslate"><span class="pre">EchoServiceAgent</span></code>.</p>
<p>Once the OEF Node computes the results, the <a class="reference internal" href="../oef.html#oef.agents.Agent.on_search_result" title="oef.agents.Agent.on_search_result"><code class="xref py py-func docutils literal notranslate"><span class="pre">on_search_result()</span></code></a> callback is called.</p>
</div>
</div>
<div class="section" id="message-exchange">
<h3>Message Exchange<a class="headerlink" href="#message-exchange" title="Permalink to this headline">¶</a></h3>
<p>If you run the agents in different consoles, you can check the log messages that they produced.</p>
<p>The output from the client agent should be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">echo_client</span><span class="p">]:</span> <span class="n">Make</span> <span class="n">search</span> <span class="n">to</span> <span class="n">the</span> <span class="n">OEF</span>
<span class="p">[</span><span class="n">echo_client</span><span class="p">]:</span> <span class="n">search_id</span><span class="o">=</span><span class="mf">0.</span> <span class="n">Agents</span> <span class="n">found</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;echo_server&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="n">echo_client</span><span class="p">]:</span> <span class="n">Sending</span> <span class="sa">b</span><span class="s1">&#39;hello&#39;</span> <span class="n">to</span> <span class="n">echo_server</span>
<span class="p">[</span><span class="n">echo_client</span><span class="p">]:</span> <span class="n">Received</span> <span class="n">message</span><span class="p">:</span> <span class="n">msg_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">echo_server</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;hello&#39;</span>
<span class="p">[</span><span class="n">echo_client</span><span class="p">]:</span> <span class="n">Stopping</span><span class="o">...</span>
<span class="p">[</span><span class="n">echo_client</span><span class="p">]:</span> <span class="n">Disconnecting</span><span class="o">...</span>
</pre></div>
</div>
<p>Whereas, the one from the server agent is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">echo_server</span><span class="p">]:</span> <span class="n">Waiting</span> <span class="k">for</span> <span class="n">messages</span><span class="o">...</span>
<span class="p">[</span><span class="n">echo_server</span><span class="p">]:</span> <span class="n">Received</span> <span class="n">message</span><span class="p">:</span> <span class="n">msg_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">echo_client</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;hello&#39;</span>
<span class="p">[</span><span class="n">echo_server</span><span class="p">]:</span> <span class="n">Sending</span> <span class="sa">b</span><span class="s1">&#39;hello&#39;</span> <span class="n">back</span> <span class="n">to</span> <span class="n">echo_client</span>
</pre></div>
</div>
<p>The order of the exchanged message is the following:</p>
<ol class="arabic simple">
<li><p>The service agent <code class="docutils literal notranslate"><span class="pre">echo_server</span></code> registers itself to the OEF Node and waits for messages.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">echo_client</span></code> queries to the OEF Node</p></li>
<li><p>The OEF Node sends back the list of agents who satisfy
the query constraints. In this trivial example,
the only agent returned is the <code class="docutils literal notranslate"><span class="pre">echo_server</span></code>.</p></li>
<li><p>The client sends a <code class="docutils literal notranslate"><span class="pre">&quot;hello&quot;</span></code> message to the OEF Node,
which targets the <code class="docutils literal notranslate"><span class="pre">echo_server</span></code></p></li>
<li><p>The OEF Node dispatches the message from <code class="docutils literal notranslate"><span class="pre">echo_client</span></code> to <code class="docutils literal notranslate"><span class="pre">echo_server</span></code></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">echo_server</span></code> receives the message and sends a new message (with the same content)
to the OEF Node, which targets the <code class="docutils literal notranslate"><span class="pre">echo_client</span></code></p></li>
<li><p>The OEF Node dispatch the message from <code class="docutils literal notranslate"><span class="pre">echo_server</span></code> to <code class="docutils literal notranslate"><span class="pre">echo_client</span></code></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">echo_client</span></code> receives the echo message.</p></li>
</ol>
<p>Follows the sequence diagram with the message exchange.</p>
<div class="figure align-center" id="id3">

            <style>
            /* mermaid issue 527 workaround */
            .section {
                opacity: 1.0 !important;
            }
            </style>
            <script>mermaid.initialize({startOnLoad:true});</script><div class="mermaid">
            sequenceDiagram
        participant Echo Client
        participant OEF Node
        participant Echo Service
        Echo Service-&gt;&gt;OEF Node: (1) register service;
        Echo Service-&gt;&gt;Echo Service: run(), waiting for messages...
        activate Echo Service
        Echo Client-&gt;&gt;OEF Node: (2) search services;
        Echo Client-&gt;&gt;Echo Client: run(), waiting for messages...
        activate Echo Client
        OEF Node-&gt;&gt;Echo Client: (3) search result;
        activate Echo Client
        note left of Echo Client: on_search_result() called
        Echo Client-&gt;&gt;OEF Node: (4) &quot;hello&quot; to &quot;echo_server&quot;:
        deactivate Echo Client
        OEF Node-&gt;&gt;Echo Service: (5) &quot;hello&quot; from &quot;echo_client&quot;;
        activate Echo Service
        note right of Echo Service:on_message() called;
        Echo Service -&gt;&gt;OEF Node: (7) &quot;hello&quot; to &quot;echo_client&quot;
        deactivate Echo Service
        OEF Node -&gt;&gt;Echo Client: (8) &quot;hello&quot; from &quot;echo_server&quot;
        activate Echo Client
        note left of Echo Client: on_message() called;
        Echo Client-&gt;&gt;Echo Client: stop()
        deactivate Echo Client
        deactivate Echo Service
        deactivate Echo Client
        </div><p class="caption"><span class="caption-text">The exchange of messages in the Echo example.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="second-example-weather-station">
<h2>Second example: Weather Station<a class="headerlink" href="#second-example-weather-station" title="Permalink to this headline">¶</a></h2>
<p>In this second example, consider the following scenario:</p>
<ul class="simple">
<li><p>A <cite>weather station</cite> provides measurements of
some physical quantity (e.g. wind speed, temperature, air pressure)</p></li>
<li><p>A <cite>weather client</cite> is interested in these measurements.</p></li>
</ul>
<p>The owner of the weather station wants to sell the data it measures.
In the following sections, we describe a
protocol that allows the agents to:</p>
<ul class="simple">
<li><p>request resources (physical assets, services, information etc.)</p></li>
<li><p>make price proposals on the negotiated resources</p></li>
<li><p>accept/decline proposals.</p></li>
</ul>
<p>You can check the full code <a class="reference external" href="https://github.com/fetchai/oef-sdk-python/tree/master/examples/weather">here</a>.</p>
<div class="section" id="weather-station-agent">
<h3>Weather Station Agent<a class="headerlink" href="#weather-station-agent" title="Permalink to this headline">¶</a></h3>
<div class="section" id="define-a-datamodel">
<h4>Define a DataModel<a class="headerlink" href="#define-a-datamodel" title="Permalink to this headline">¶</a></h4>
<p>For this example, we need a specific data model that can effectively describe the features of services.</p>
<p>Let’s start with an attribute to represent whether a weather station provides a measure for physical quantities, e.g.
wind speed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oef.schema</span> <span class="kn">import</span> <span class="n">AttributeSchema</span>

<span class="n">WIND_SPEED_ATTR</span> <span class="o">=</span> <span class="n">AttributeSchema</span><span class="p">(</span>
    <span class="s2">&quot;wind_speed&quot;</span><span class="p">,</span>
    <span class="nb">bool</span><span class="p">,</span>
    <span class="n">is_attribute_required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">attribute_description</span><span class="o">=</span><span class="s2">&quot;Provides wind speed measurements.&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../oef.html#oef.schema.AttributeSchema" title="oef.schema.AttributeSchema"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttributeSchema</span></code></a> class constructor requires:</p>
<ul class="simple">
<li><p>The name of the attribute;</p></li>
<li><p>The type of the attribute: it can be one of <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">bool</span></code> and <code class="docutils literal notranslate"><span class="pre">str</span></code>;</p></li>
<li><p>A flag to determine whether the instances of the data model (that is <a class="reference internal" href="../oef.html#oef.schema.Description" title="oef.schema.Description"><code class="xref py py-class docutils literal notranslate"><span class="pre">Description</span></code></a>) need to specify a value;</p></li>
<li><p>A description of the meaning of the attribute.</p></li>
</ul>
<p>In this case, our <code class="docutils literal notranslate"><span class="pre">wind_speed</span></code> attribute is of type <code class="docutils literal notranslate"><span class="pre">bool</span></code>. If the description of a weather station has the value
<code class="docutils literal notranslate"><span class="pre">wind_speed</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then it means that it can provide measurements for the wind speed.</p>
<p>We can define other types of measurements as well:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TEMPERATURE_ATTR</span> <span class="o">=</span> <span class="n">AttributeSchema</span><span class="p">(</span>
    <span class="s2">&quot;temperature&quot;</span><span class="p">,</span>
    <span class="nb">bool</span><span class="p">,</span>
    <span class="n">is_attribute_required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">attribute_description</span><span class="o">=</span><span class="s2">&quot;Provides temperature measurements.&quot;</span>
<span class="p">)</span>

<span class="n">AIR_PRESSURE_ATTR</span> <span class="o">=</span> <span class="n">AttributeSchema</span><span class="p">(</span>
    <span class="s2">&quot;air_pressure&quot;</span><span class="p">,</span>
    <span class="nb">bool</span><span class="p">,</span>
    <span class="n">is_attribute_required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">attribute_description</span><span class="o">=</span><span class="s2">&quot;Provides air pressure measurements.&quot;</span>
<span class="p">)</span>

<span class="n">HUMIDITY_ATTR</span> <span class="o">=</span> <span class="n">AttributeSchema</span><span class="p">(</span>
    <span class="s2">&quot;humidity&quot;</span><span class="p">,</span>
    <span class="nb">bool</span><span class="p">,</span>
    <span class="n">is_attribute_required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">attribute_description</span><span class="o">=</span><span class="s2">&quot;Provides humidity measurements.&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Now we can define our data model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oef.schema</span> <span class="kn">import</span> <span class="n">DataModel</span>

<span class="n">WEATHER_DATA_MODEL</span> <span class="o">=</span> <span class="n">DataModel</span><span class="p">(</span>
    <span class="s2">&quot;weather_data&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="n">WIND_SPEED_ATTR</span><span class="p">,</span>
    <span class="n">TEMPERATURE_ATTR</span><span class="p">,</span>
    <span class="n">AIR_PRESSURE_ATTR</span><span class="p">,</span>
    <span class="n">HUMIDITY_ATTR</span><span class="p">],</span>
    <span class="s2">&quot;All possible weather data.&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>To define our data model <code class="docutils literal notranslate"><span class="pre">WEATHER_DATA_MODEL</span></code> we need a name and a list of attributes. We use the
same we defined previously, that is <code class="docutils literal notranslate"><span class="pre">WIND_SPEED_ATTR</span></code>, <code class="docutils literal notranslate"><span class="pre">AIR_PRESSURE_ATTR</span></code>, <code class="docutils literal notranslate"><span class="pre">HUMIDITY_ATTR</span></code> and <code class="docutils literal notranslate"><span class="pre">PRICE_ATTR</span></code>.</p>
</div>
<div class="section" id="define-a-description">
<h4>Define a Description<a class="headerlink" href="#define-a-description" title="Permalink to this headline">¶</a></h4>
<p>Once we have the data model, we can provide an <cite>instance</cite> of that model. To do so, we can use the
<a class="reference internal" href="../oef.html#oef.schema.Description" title="oef.schema.Description"><code class="xref py py-class docutils literal notranslate"><span class="pre">Description</span></code></a> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oef.schema</span> <span class="kn">import</span> <span class="n">Description</span>

<span class="n">weather_service_description</span> <span class="o">=</span> <span class="n">Description</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;wind_speed&quot;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
        <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s2">&quot;air_pressure&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s2">&quot;humidity&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">WEATHER_DATA_MODEL</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The first argument is a dictionary where:</p>
<ul class="simple">
<li><p>the keys are the names of the attributes;</p></li>
<li><p>the values are the instantiation of the attribute schema specification.</p></li>
</ul>
<p>The second argument is the data model the description is referring to.</p>
<p>We will use this description to register our service to the OEF. In this way, other agents can make queries defined over
the data model <code class="docutils literal notranslate"><span class="pre">WEATHER_DATA_MODEL</span></code> and discover the service.</p>
</div>
<div class="section" id="define-the-weatherstation-agent">
<h4>Define the WeatherStation agent<a class="headerlink" href="#define-the-weatherstation-agent" title="Permalink to this headline">¶</a></h4>
<p>This is the code for our weather station:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oef.agents</span> <span class="kn">import</span> <span class="n">OEFAgent</span>
<span class="kn">from</span> <span class="nn">oef.schema</span> <span class="kn">import</span> <span class="n">Description</span>
<span class="kn">from</span> <span class="nn">oef.messages</span> <span class="kn">import</span> <span class="n">CFP_TYPES</span>
<span class="kn">import</span> <span class="nn">json</span>


 <span class="k">class</span> <span class="nc">WeatherStation</span><span class="p">(</span><span class="n">OEFAgent</span><span class="p">):</span>
     <span class="sd">&quot;&quot;&quot;Class that implements the behaviour of the weather station.&quot;&quot;&quot;</span>

     <span class="n">weather_service_description</span> <span class="o">=</span> <span class="n">Description</span><span class="p">(</span>
         <span class="p">{</span>
             <span class="s2">&quot;wind_speed&quot;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
             <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
             <span class="s2">&quot;air_pressure&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
             <span class="s2">&quot;humidity&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
         <span class="p">},</span>
         <span class="n">WEATHER_DATA_MODEL</span>
     <span class="p">)</span>

     <span class="k">def</span> <span class="nf">on_cfp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">origin</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">CFP_TYPES</span><span class="p">):</span>
         <span class="sd">&quot;&quot;&quot;Send a simple Propose to the sender of the CFP.&quot;&quot;&quot;</span>
         <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{0}]: Received CFP from {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">origin</span><span class="p">))</span>

         <span class="c1"># prepare the proposal with a given price.</span>
         <span class="n">price</span> <span class="o">=</span> <span class="mi">50</span>
         <span class="n">proposal</span> <span class="o">=</span> <span class="n">Description</span><span class="p">({</span><span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">})</span>
         <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: Sending propose at price: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">price</span><span class="p">))</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">send_propose</span><span class="p">(</span><span class="n">msg_id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">target</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">proposal</span><span class="p">])</span>

     <span class="k">def</span> <span class="nf">on_accept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">origin</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
         <span class="sd">&quot;&quot;&quot;Once we received an Accept, send the requested data.&quot;&quot;&quot;</span>
         <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{0}]: Received accept from {1}.&quot;</span>
               <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">origin</span><span class="p">))</span>

         <span class="c1"># send the measurements to the client. for the sake of simplicity, they are hard-coded.</span>
         <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">,</span> <span class="s2">&quot;humidity&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;air_pressure&quot;</span><span class="p">:</span> <span class="mf">1019.0</span><span class="p">}</span>
         <span class="n">encoded_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
         <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{0}]: Sending data to {1}: {2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">pprint</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">encoded_data</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>when the agent receives a CFP, it answers with a list of relevant resources, that constitutes his proposal.
In this simplified example, he answers with only one Description object, that specifies the price of the negotiation.</p></li>
<li><p>on Accept messages, he answers with the available measurements. For the sake of simplicity, they are hard-coded.</p></li>
</ul>
<p>And here is the code to run the agent:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">WeatherStation</span><span class="p">(</span><span class="s2">&quot;weather_station&quot;</span><span class="p">,</span> <span class="n">oef_addr</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">oef_port</span><span class="o">=</span><span class="mi">3333</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">agent</span><span class="o">.</span><span class="n">register_service</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">agent</span><span class="o">.</span><span class="n">weather_service_description</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Waiting for clients...&quot;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="weather-client-agent">
<h3>Weather Client Agent<a class="headerlink" href="#weather-client-agent" title="Permalink to this headline">¶</a></h3>
<p>This is the code for the client of the weather service:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">from</span> <span class="nn">oef.agents</span> <span class="kn">import</span> <span class="n">OEFAgent</span>
<span class="kn">from</span> <span class="nn">oef.messages</span> <span class="kn">import</span> <span class="n">PROPOSE_TYPES</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">class</span> <span class="nc">WeatherClient</span><span class="p">(</span><span class="n">OEFAgent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class that implements the behavior of the weather client.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">on_search_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">agents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;For every agent returned in the service search, send a CFP to obtain resources from them.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">agents</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{}]: No agent found. Stopping...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{0}]: Agent found: {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">agents</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{0}]: Sending to agent {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">agent</span><span class="p">))</span>
            <span class="c1"># we send a &#39;None&#39; query, meaning &quot;give me all the resources you can propose.&quot;</span>
            <span class="n">query</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_cfp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">agent</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_propose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">origin</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">proposals</span><span class="p">:</span> <span class="n">PROPOSE_TYPES</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;When we receive a Propose message, answer with an Accept.&quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{0}]: Received propose from agent {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">origin</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">proposals</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{0}]: Proposal {1}: {2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{0}]: Accepting Propose.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_accept</span><span class="p">(</span><span class="n">msg_id</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">msg_id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dialogue_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">origin</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extract and print data from incoming (simple) messages.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[{0}]: Received measurement from {1}: {2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">pprint</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<p>His behaviour can be summarized with the following lines:</p>
<ul class="simple">
<li><p>When the agent receives a search result from the OEF (see <a class="reference internal" href="../oef.html#oef.agents.Agent.on_search_result" title="oef.agents.Agent.on_search_result"><code class="xref py py-class docutils literal notranslate"><span class="pre">on_search_result</span></code></a>),
it sends a CFP to every weather station found. This message starts a negotiation with every agent.
For simplicity, the CFP contains a query with an empty list of constraints, meaning that we do not specify constraints
on the set of proposals we can receive.</p></li>
<li><p>When the agent receives a Propose message, he will automatically accept the proposal, sending an Accept message.
Here it is possible to implement multiple strategies, e.g. find the proposal with the minimum
across different services.</p></li>
<li><p>Then he waits to receive the measurements from the weather station.</p></li>
</ul>
<p>And here’s the code to run it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oef.query</span> <span class="kn">import</span> <span class="n">Query</span><span class="p">,</span> <span class="n">Constraint</span><span class="p">,</span> <span class="n">Eq</span>

<span class="n">agent</span> <span class="o">=</span> <span class="n">WeatherClient</span><span class="p">(</span><span class="s2">&quot;weather_client&quot;</span><span class="p">,</span> <span class="n">oef_addr</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">oef_port</span><span class="o">=</span><span class="mi">3333</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">([</span><span class="n">Constraint</span><span class="p">(</span><span class="n">TEMPERATURE_ATTR</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Eq</span><span class="p">(</span><span class="bp">True</span><span class="p">)),</span>
               <span class="n">Constraint</span><span class="p">(</span><span class="n">AIR_PRESSURE_ATTR</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Eq</span><span class="p">(</span><span class="bp">True</span><span class="p">)),</span>
               <span class="n">Constraint</span><span class="p">(</span><span class="n">HUMIDITY_ATTR</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Eq</span><span class="p">(</span><span class="bp">True</span><span class="p">))],</span>
               <span class="n">WEATHER_DATA_MODEL</span><span class="p">)</span>

<span class="n">agent</span><span class="o">.</span><span class="n">search_services</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</pre></div>
</div>
<p>Notice how we built the <a class="reference internal" href="../oef.html#oef.query.Query" title="oef.query.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object, used to search weather services. The query requires:</p>
<ul class="simple">
<li><p>a data model over which the query is defined</p></li>
<li><p>a list of <a class="reference internal" href="../oef.html#oef.query.Constraint" title="oef.query.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a> object. Each constraint is defined over attributes of the data
model and imposes a restriction on the possible values that the associated attributes can assume.</p></li>
</ul>
<p>In this example, we require that the <a class="reference internal" href="../oef.html#oef.schema.Description" title="oef.schema.Description"><code class="xref py py-class docutils literal notranslate"><span class="pre">Description</span></code></a> of the services registered in the OEF
is compliant with the following conditions:</p>
<ul class="simple">
<li><p>The description is defined over the <code class="docutils literal notranslate"><span class="pre">WEATHER_DATA_MODEL</span></code> (defined before)</p></li>
<li><p>The fields <cite>temperature</cite>, <cite>humidity</cite> and <cite>air pressure</cite> must be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> (that is, the service provides the
associated measurements.
To specify this kind of constraint, we use the class <code class="xref py py-class docutils literal notranslate"><span class="pre">Eq</span></code> that express the constraint of equality
to a specific value.</p></li>
</ul>
<p>To give a better idea, you can think about this query as an equivalent of the following SQL-like query:</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">weather_data</span> <span class="k">WHERE</span>
  <span class="n">temperature</span> <span class="o">=</span> <span class="k">true</span> <span class="k">and</span>
  <span class="n">air_pressure</span> <span class="o">=</span> <span class="k">true</span> <span class="k">and</span>
  <span class="n">humidity</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>In other sections of the documentation, you can find more details about the query language and other types of constraint.</p>
</div>
<div class="section" id="id2">
<h3>Message Exchange<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>The output from the client agent should be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[weather_station]: Waiting for clients...
[weather_station]: Received CFP from weather_client
[weather_station]: Sending propose at price: 50
[weather_station]: Received accept from weather_client.
[weather_station]: sending data to weather_client: {&#39;air_pressure&#39;: 1019.0, &#39;humidity&#39;: 0.7, &#39;temperature&#39;: 15.0}
</pre></div>
</div>
<p>Whereas, the one from the server agent is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[weather_station]: Waiting for clients...
[weather_station]: Received CFP from weather_client
[weather_station]: Sending propose at price: 50
[weather_station]: Received accept from weather_client.
[weather_station]: sending data to weather_client: {&#39;air_pressure&#39;: 1019.0, &#39;humidity&#39;: 0.7, &#39;temperature&#39;: 15.0}
</pre></div>
</div>
<p>Follows the summary of the communication between the weather client and the weather station:</p>
<ol class="arabic simple">
<li><p>The weather station agent registers to the OEF and waits for messages.</p></li>
<li><p>The client sends a search result with a query, looking for weather stations
that provide measurements for temperature, humidity and air pressure.
Then, he waits for messages.</p></li>
<li><p>The OEF answers with the services that satisfy the query.</p></li>
<li><p>The client sends a CFP to the service via the OEF Node. The node forwards it to the recipient.</p></li>
<li><p>The weather station answers with a proposal.</p></li>
<li><p>The client accepts the proposal and notifies the weather station.</p></li>
<li><p>The station sends messages to the client with the desired measurements.</p></li>
</ol>
<p>Follows the sequence diagram with the message exchange.</p>
<div class="figure align-center" id="id4">

            <style>
            /* mermaid issue 527 workaround */
            .section {
                opacity: 1.0 !important;
            }
            </style>
            <div class="mermaid">
            sequenceDiagram
        participant Weather Client
        participant OEF Node
        participant Weather Service
        Weather Service-&gt;&gt;OEF Node: (1) register service;
        Weather Service-&gt;&gt;Weather Service: run(), waiting for messages...
        activate Weather Service
        Weather Client-&gt;&gt;OEF Node: (2) search services;
        Weather Client-&gt;&gt;Weather Client: run(), waiting for messages...
        activate Weather Client
        OEF Node-&gt;&gt;Weather Client: (3) search result;
        activate Weather Client
        note left of Weather Client: on_search_result() called
        Weather Client-&gt;&gt;OEF Node: (4) CFP(query):
        deactivate Weather Client
        OEF Node-&gt;&gt;Weather Service: CFP(query);
        activate Weather Service
        note right of Weather Service:on_cfp() called;
        Weather Service -&gt;&gt;OEF Node: (5) Propose(id, price)
        deactivate Weather Service
        OEF Node -&gt;&gt;Weather Client: Propose(id, price)
        activate Weather Client
        note left of Weather Client: on_propose() called;
        Weather Client-&gt;&gt;OEF Node: (6) Accept(id)
        deactivate Weather Client
        OEF Node-&gt;&gt;Weather Service: Accept(id)
        activate Weather Service
        note right of Weather Service:on_accept() called;
        Weather Service -&gt;&gt;OEF Node: (7) Message(data)
        deactivate Weather Service
        OEF Node -&gt;&gt;Weather Client: Message(data)
        activate Weather Client
        note left of Weather Client: on_message() called;
        Weather Client-&gt;&gt;Weather Client: stop()
        deactivate Weather Client
        deactivate Weather Service
        deactivate Weather Client
        </div><p class="caption"><span class="caption-text">The exchange of messages in the Weather example.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>Notice: in step (6), instead of the <cite>Accept</cite> action, we might have had a counter-Propose, or a <cite>Decline</cite>.
<cite>Decline</cite> means that the sender is not interested anymore in continuing the negotiation with the recipient.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="defining-data-model.html" class="btn btn-neutral float-right" title="Defining Data Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="oef-node.html" class="btn btn-neutral float-left" title="Set up an OEF Node" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018 Fetch.AI Limited

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>