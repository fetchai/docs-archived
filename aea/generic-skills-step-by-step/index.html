
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Everything you need to know about Fetch.ai.">
      
      
      
        <link rel="canonical" href="https://docs.fetch.ai/aea/generic-skills-step-by-step/">
      
      
        <meta name="author" content="developer@fetch.ai">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.6">
    
    
      
        <title>Trade between two AEAs - Developer Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6910b76c.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.196e0c26.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/style.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-118969813-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dependencies-required" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://docs.fetch.ai/" title="Developer Documentation" class="md-header-nav__button md-logo" aria-label="Developer Documentation">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Developer Documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Trade between two AEAs
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/fetchai/docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://docs.fetch.ai/" title="Developer Documentation" class="md-nav__button md-logo" aria-label="Developer Documentation">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    Developer Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/fetchai/docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    <label class="md-nav__link" for="nav-2">
      Agent Framework
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Agent Framework" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Agent Framework
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../version/" class="md-nav__link">
      Version
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3" >
    <label class="md-nav__link" for="nav-2-3">
      Concepts
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Concepts" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon"></span>
        Concepts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../language-agnostic-definition/" class="md-nav__link">
      Language Agnostic Definition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../agent-oriented-development/" class="md-nav__link">
      Agent-oriented development
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vision/" class="md-nav__link">
      Vision
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../app-areas/" class="md-nav__link">
      Application areas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../oef-ledger/" class="md-nav__link">
      Relation to OEF and Ledger
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../identity/" class="md-nav__link">
      Identity
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4" >
    <label class="md-nav__link" for="nav-2-4">
      Demos
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Demos" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        <span class="md-nav__icon md-icon"></span>
        Demos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../demos/" class="md-nav__link">
      Demos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aries-cloud-agent-demo/" class="md-nav__link">
      Aries Cloud Agents Demo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../car-park-skills/" class="md-nav__link">
      Car park skills
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gym-example/" class="md-nav__link">
      Gym example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gym-skill/" class="md-nav__link">
      Gym skill
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ml-skills/" class="md-nav__link">
      ML skills
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tac-skills/" class="md-nav__link">
      TAC skills
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tac-skills-contract/" class="md-nav__link">
      TAC skills ledger-based
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tac/" class="md-nav__link">
      TAC external app
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../thermometer-skills/" class="md-nav__link">
      Thermometer skills
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../weather-skills/" class="md-nav__link">
      Weather skills
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5" checked>
    <label class="md-nav__link" for="nav-2-5">
      Development
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Development" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        <span class="md-nav__icon md-icon"></span>
        Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-1" type="checkbox" id="nav-2-5-1" checked>
    <label class="md-nav__link" for="nav-2-5-1">
      Getting started
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Getting started" data-md-level="3">
      <label class="md-nav__title" for="nav-2-5-1">
        <span class="md-nav__icon md-icon"></span>
        Getting started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../quickstart/" class="md-nav__link">
      AEA quick start
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core-components-1/" class="md-nav__link">
      Core components - Part 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aea-vs-mvc/" class="md-nav__link">
      AEA and web frameworks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../skill-guide/" class="md-nav__link">
      Build a skill for an AEA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core-components-2/" class="md-nav__link">
      Core components - Part 2
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Trade between two AEAs
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Trade between two AEAs
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependencies-required" class="md-nav__link">
    Dependencies (Required)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference-optional" class="md-nav__link">
    Reference (Optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simplification-step" class="md-nav__link">
    Simplification step
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generic-seller-aea" class="md-nav__link">
    Generic Seller AEA
  </a>
  
    <nav class="md-nav" aria-label="Generic Seller AEA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-aea" class="md-nav__link">
    Step 1: Create the AEA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-create-the-behaviour" class="md-nav__link">
    Step 2: Create the behaviour
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-create-the-handler" class="md-nav__link">
    Step 3: Create the handler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-create-the-strategy" class="md-nav__link">
    Step 4: Create the strategy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-create-the-dialogues" class="md-nav__link">
    Step 5: Create the dialogues
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-update-the-yaml-files" class="md-nav__link">
    Step 6: Update the YAML files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generic-buyer-aea" class="md-nav__link">
    Generic Buyer AEA
  </a>
  
    <nav class="md-nav" aria-label="Generic Buyer AEA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-aea_1" class="md-nav__link">
    Step 1: Create the AEA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-create-the-behaviour_1" class="md-nav__link">
    Step 2: Create the behaviour
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-create-the-handler_1" class="md-nav__link">
    Step 3: Create the handler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-create-the-strategy_1" class="md-nav__link">
    Step 4: Create the strategy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-create-the-dialogues_1" class="md-nav__link">
    Step 5: Create the dialogues
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-update-the-yaml-files_1" class="md-nav__link">
    Step 6: Update the YAML files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-aeas" class="md-nav__link">
    Run the AEAs
  </a>
  
    <nav class="md-nav" aria-label="Run the AEAs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-private-keys" class="md-nav__link">
    Create private keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-the-aea-configs" class="md-nav__link">
    Update the AEA configs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fund-the-buyer-aea" class="md-nav__link">
    Fund the buyer AEA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-seller-aea" class="md-nav__link">
    Run seller AEA
  </a>
  
    <nav class="md-nav" aria-label="Run seller AEA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-buyer-aea" class="md-nav__link">
    Run buyer AEA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete-the-aeas" class="md-nav__link">
    Delete the AEAs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next steps
  </a>
  
    <nav class="md-nav" aria-label="Next steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommended" class="md-nav__link">
    Recommended
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-2" type="checkbox" id="nav-2-5-2" >
    <label class="md-nav__link" for="nav-2-5-2">
      Topic guides
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Topic guides" data-md-level="3">
      <label class="md-nav__title" for="nav-2-5-2">
        <span class="md-nav__icon md-icon"></span>
        Topic guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../step-one/" class="md-nav__link">
      Ways to build an AEA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../development-setup/" class="md-nav__link">
      Development setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../build-aea-step-by-step/" class="md-nav__link">
      Build an AEA with the CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scaffolding/" class="md-nav__link">
      Scaffolding packages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../protocol-generator/" class="md-nav__link">
      Generating protocols
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../logging/" class="md-nav__link">
      Logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../multiplexer-standalone/" class="md-nav__link">
      Use multiplexer stand-alone
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../standalone-transaction/" class="md-nav__link">
      Create stand-alone transaction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../decision-maker-transaction/" class="md-nav__link">
      Create decision-maker transaction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../skill-testing/" class="md-nav__link">
      Testing Skills
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployment/" class="md-nav__link">
      Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../known-limits/" class="md-nav__link">
      Known limitations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../build-aea-programmatically/" class="md-nav__link">
      Build an AEA programmatically
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli-vs-programmatic-aeas/" class="md-nav__link">
      CLI vs programmatic AEAs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../agent-vs-aea/" class="md-nav__link">
      AEAs vs agents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../upgrading/" class="md-nav__link">
      Upgrading versions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../modes/" class="md-nav__link">
      Modes of running an AEA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../multi-agent-manager/" class="md-nav__link">
      Multi agent manager
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../debug/" class="md-nav__link">
      Debugging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../runtime-cost/" class="md-nav__link">
      Profiling
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-3" type="checkbox" id="nav-2-5-3" >
    <label class="md-nav__link" for="nav-2-5-3">
      Use case components
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Use case components" data-md-level="3">
      <label class="md-nav__title" for="nav-2-5-3">
        <span class="md-nav__icon md-icon"></span>
        Use case components
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../generic-skills/" class="md-nav__link">
      Generic skills
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-a-frontend/" class="md-nav__link">
      Front-end intergration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../http-connection-and-skill/" class="md-nav__link">
      HTTP Connection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../orm-integration/" class="md-nav__link">
      ORM integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../erc1155-skills/" class="md-nav__link">
      Contract deploy and interact
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../p2p-connection/" class="md-nav__link">
      P2P Connection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../raspberry-set-up/" class="md-nav__link">
      Build an AEA on a Raspberry Pi
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-4" type="checkbox" id="nav-2-5-4" >
    <label class="md-nav__link" for="nav-2-5-4">
      Architecture & component deep-dives
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Architecture & component deep-dives" data-md-level="3">
      <label class="md-nav__title" for="nav-2-5-4">
        <span class="md-nav__icon md-icon"></span>
        Architecture & component deep-dives
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../design-principles/" class="md-nav__link">
      Design principles
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../diagram/" class="md-nav__link">
      Architectural diagram
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connection/" class="md-nav__link">
      Connections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../protocol/" class="md-nav__link">
      Protocols
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../skill/" class="md-nav__link">
      Skills
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../contract/" class="md-nav__link">
      Contracts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../decision-maker/" class="md-nav__link">
      Decision Maker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ledger-integration/" class="md-nav__link">
      Ledger & Crypto APIs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../message-routing/" class="md-nav__link">
      Message routing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../config/" class="md-nav__link">
      Configurations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-5" type="checkbox" id="nav-2-5-5" >
    <label class="md-nav__link" for="nav-2-5-5">
      Agent Communication
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Agent Communication" data-md-level="3">
      <label class="md-nav__title" for="nav-2-5-5">
        <span class="md-nav__icon md-icon"></span>
        Agent Communication
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../acn/" class="md-nav__link">
      Agent Communication Network
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-6" type="checkbox" id="nav-2-5-6" >
    <label class="md-nav__link" for="nav-2-5-6">
      Search & Discovery
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Search & Discovery" data-md-level="3">
      <label class="md-nav__title" for="nav-2-5-6">
        <span class="md-nav__icon md-icon"></span>
        Search & Discovery
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../defining-data-models/" class="md-nav__link">
      Defining Data Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../query-language/" class="md-nav__link">
      The Query Language
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../simple-oef-usage/" class="md-nav__link">
      SOEF Connection
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-7" type="checkbox" id="nav-2-5-7" >
    <label class="md-nav__link" for="nav-2-5-7">
      Developer Interfaces
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Developer Interfaces" data-md-level="3">
      <label class="md-nav__title" for="nav-2-5-7">
        <span class="md-nav__icon md-icon"></span>
        Developer Interfaces
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-7-1" type="checkbox" id="nav-2-5-7-1" >
    <label class="md-nav__link" for="nav-2-5-7-1">
      CLI
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="CLI" data-md-level="4">
      <label class="md-nav__title" for="nav-2-5-7-1">
        <span class="md-nav__icon md-icon"></span>
        CLI
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../cli-how-to/" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli-commands/" class="md-nav__link">
      Commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../package-imports/" class="md-nav__link">
      File structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wealth/" class="md-nav__link">
      Generating wealth
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli-gui/" class="md-nav__link">
      GUI
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-8" type="checkbox" id="nav-2-5-8" >
    <label class="md-nav__link" for="nav-2-5-8">
      Benchmarks
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Benchmarks" data-md-level="3">
      <label class="md-nav__title" for="nav-2-5-8">
        <span class="md-nav__icon md-icon"></span>
        Benchmarks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../performance-benchmark/" class="md-nav__link">
      Performance benchmark
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9" type="checkbox" id="nav-2-5-9" >
    <label class="md-nav__link" for="nav-2-5-9">
      API
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="API" data-md-level="3">
      <label class="md-nav__title" for="nav-2-5-9">
        <span class="md-nav__icon md-icon"></span>
        API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/abstract_agent/" class="md-nav__link">
      AbstractAgent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/aea/" class="md-nav__link">
      AEA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/aea_builder/" class="md-nav__link">
      AEA Builder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/agent/" class="md-nav__link">
      Agent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/agent_loop/" class="md-nav__link">
      Agent Loop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/common/" class="md-nav__link">
      Common
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/exceptions/" class="md-nav__link">
      Exceptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/launcher/" class="md-nav__link">
      Launcher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/manager/" class="md-nav__link">
      Manager
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/multiplexer/" class="md-nav__link">
      Multiplexer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/runner/" class="md-nav__link">
      Runner
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/runtime/" class="md-nav__link">
      Runtime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-13" type="checkbox" id="nav-2-5-9-13" >
    <label class="md-nav__link" for="nav-2-5-9-13">
      Components
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Components" data-md-level="4">
      <label class="md-nav__title" for="nav-2-5-9-13">
        <span class="md-nav__icon md-icon"></span>
        Components
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/components/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/components/loader/" class="md-nav__link">
      Loader
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-14" type="checkbox" id="nav-2-5-9-14" >
    <label class="md-nav__link" for="nav-2-5-9-14">
      Configurations
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Configurations" data-md-level="4">
      <label class="md-nav__title" for="nav-2-5-9-14">
        <span class="md-nav__icon md-icon"></span>
        Configurations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/configurations/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/configurations/constants/" class="md-nav__link">
      Constants
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/configurations/loader/" class="md-nav__link">
      Loader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/configurations/project/" class="md-nav__link">
      Project
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/configurations/pypi/" class="md-nav__link">
      Pypi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/configurations/utils/" class="md-nav__link">
      Utils
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-15" type="checkbox" id="nav-2-5-9-15" >
    <label class="md-nav__link" for="nav-2-5-9-15">
      Connections
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Connections" data-md-level="4">
      <label class="md-nav__title" for="nav-2-5-9-15">
        <span class="md-nav__icon md-icon"></span>
        Connections
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/connections/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/connections/stub/connection/" class="md-nav__link">
      Stub Connection
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/context/base/" class="md-nav__link">
      Context
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-17" type="checkbox" id="nav-2-5-9-17" >
    <label class="md-nav__link" for="nav-2-5-9-17">
      Contracts
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Contracts" data-md-level="4">
      <label class="md-nav__title" for="nav-2-5-9-17">
        <span class="md-nav__icon md-icon"></span>
        Contracts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/contracts/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-18" type="checkbox" id="nav-2-5-9-18" >
    <label class="md-nav__link" for="nav-2-5-9-18">
      Crypto
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Crypto" data-md-level="4">
      <label class="md-nav__title" for="nav-2-5-9-18">
        <span class="md-nav__icon md-icon"></span>
        Crypto
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/crypto/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/crypto/cosmos/" class="md-nav__link">
      Cosmos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/crypto/ethereum/" class="md-nav__link">
      Ethereum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/crypto/fetchai/" class="md-nav__link">
      Fetchai
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/crypto/helpers/" class="md-nav__link">
      Helpers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/crypto/ledger_apis/" class="md-nav__link">
      LedgerApis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/crypto/wallet/" class="md-nav__link">
      Wallet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-18-8" type="checkbox" id="nav-2-5-9-18-8" >
    <label class="md-nav__link" for="nav-2-5-9-18-8">
      Registries
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Registries" data-md-level="5">
      <label class="md-nav__title" for="nav-2-5-9-18-8">
        <span class="md-nav__icon md-icon"></span>
        Registries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/crypto/registries/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-19" type="checkbox" id="nav-2-5-9-19" >
    <label class="md-nav__link" for="nav-2-5-9-19">
      Decision Maker
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Decision Maker" data-md-level="4">
      <label class="md-nav__title" for="nav-2-5-9-19">
        <span class="md-nav__icon md-icon"></span>
        Decision Maker
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/decision_maker/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/decision_maker/default/" class="md-nav__link">
      Default
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-20" type="checkbox" id="nav-2-5-9-20" >
    <label class="md-nav__link" for="nav-2-5-9-20">
      Helpers
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Helpers" data-md-level="4">
      <label class="md-nav__title" for="nav-2-5-9-20">
        <span class="md-nav__icon md-icon"></span>
        Helpers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/async_friendly_queue/" class="md-nav__link">
      Async Friendly Queue
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/async_utils/" class="md-nav__link">
      Async Utils
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-20-4" type="checkbox" id="nav-2-5-9-20-4" >
    <label class="md-nav__link" for="nav-2-5-9-20-4">
      Dialogue
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Dialogue" data-md-level="5">
      <label class="md-nav__title" for="nav-2-5-9-20-4">
        <span class="md-nav__icon md-icon"></span>
        Dialogue
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/dialogue/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/exception_policy/" class="md-nav__link">
      Exception Policy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/exec_timeout/" class="md-nav__link">
      Exec Timeout
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/file_io/" class="md-nav__link">
      File IO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/file_lock/" class="md-nav__link">
      File Lock
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/install_dependency/" class="md-nav__link">
      Install Dependencies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-20-10" type="checkbox" id="nav-2-5-9-20-10" >
    <label class="md-nav__link" for="nav-2-5-9-20-10">
      IPFS
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="IPFS" data-md-level="5">
      <label class="md-nav__title" for="nav-2-5-9-20-10">
        <span class="md-nav__icon md-icon"></span>
        IPFS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/ipfs/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/logging/" class="md-nav__link">
      Logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-20-12" type="checkbox" id="nav-2-5-9-20-12" >
    <label class="md-nav__link" for="nav-2-5-9-20-12">
      MultiAddress
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="MultiAddress" data-md-level="5">
      <label class="md-nav__title" for="nav-2-5-9-20-12">
        <span class="md-nav__icon md-icon"></span>
        MultiAddress
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/multiaddr/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/multiple_executor/" class="md-nav__link">
      MultipleExecutor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/pipe/" class="md-nav__link">
      Pipe
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-20-15" type="checkbox" id="nav-2-5-9-20-15" >
    <label class="md-nav__link" for="nav-2-5-9-20-15">
      Preferences
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Preferences" data-md-level="5">
      <label class="md-nav__title" for="nav-2-5-9-20-15">
        <span class="md-nav__icon md-icon"></span>
        Preferences
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/preference_representations/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/profiling/" class="md-nav__link">
      Profiling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-20-17" type="checkbox" id="nav-2-5-9-20-17" >
    <label class="md-nav__link" for="nav-2-5-9-20-17">
      Search
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Search" data-md-level="5">
      <label class="md-nav__title" for="nav-2-5-9-20-17">
        <span class="md-nav__icon md-icon"></span>
        Search
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/search/generic/" class="md-nav__link">
      Generic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/search/models/" class="md-nav__link">
      Models
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/sym_link/" class="md-nav__link">
      Sym Link
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/temp_error_handler/" class="md-nav__link">
      Temp Error Handler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-20-20" type="checkbox" id="nav-2-5-9-20-20" >
    <label class="md-nav__link" for="nav-2-5-9-20-20">
      Transaction
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Transaction" data-md-level="5">
      <label class="md-nav__title" for="nav-2-5-9-20-20">
        <span class="md-nav__icon md-icon"></span>
        Transaction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/transaction/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/win32/" class="md-nav__link">
      Win32
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/helpers/yaml_utils/" class="md-nav__link">
      YamlUtils
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/identity/base/" class="md-nav__link">
      Identity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/mail/base/" class="md-nav__link">
      Mail
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-23" type="checkbox" id="nav-2-5-9-23" >
    <label class="md-nav__link" for="nav-2-5-9-23">
      Protocols
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Protocols" data-md-level="4">
      <label class="md-nav__title" for="nav-2-5-9-23">
        <span class="md-nav__icon md-icon"></span>
        Protocols
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-23-2" type="checkbox" id="nav-2-5-9-23-2" >
    <label class="md-nav__link" for="nav-2-5-9-23-2">
      Generator
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Generator" data-md-level="5">
      <label class="md-nav__title" for="nav-2-5-9-23-2">
        <span class="md-nav__icon md-icon"></span>
        Generator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/generator/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/generator/common/" class="md-nav__link">
      Common
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/generator/extract_specification/" class="md-nav__link">
      Extract Specification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/generator/validate/" class="md-nav__link">
      Validate
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-23-3" type="checkbox" id="nav-2-5-9-23-3" >
    <label class="md-nav__link" for="nav-2-5-9-23-3">
      Default Protocol
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Default Protocol" data-md-level="5">
      <label class="md-nav__title" for="nav-2-5-9-23-3">
        <span class="md-nav__icon md-icon"></span>
        Default Protocol
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/default/custom_types/" class="md-nav__link">
      Custom Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/default/dialogues/" class="md-nav__link">
      Dialogues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/default/message/" class="md-nav__link">
      Message
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/default/serialization/" class="md-nav__link">
      Serialization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-23-4" type="checkbox" id="nav-2-5-9-23-4" >
    <label class="md-nav__link" for="nav-2-5-9-23-4">
      Signing Protocol
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Signing Protocol" data-md-level="5">
      <label class="md-nav__title" for="nav-2-5-9-23-4">
        <span class="md-nav__icon md-icon"></span>
        Signing Protocol
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/signing/custom_types/" class="md-nav__link">
      Custom Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/signing/dialogues/" class="md-nav__link">
      Dialogues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/signing/message/" class="md-nav__link">
      Message
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/signing/serialization/" class="md-nav__link">
      Serialization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-23-5" type="checkbox" id="nav-2-5-9-23-5" >
    <label class="md-nav__link" for="nav-2-5-9-23-5">
      State Update Protocol
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="State Update Protocol" data-md-level="5">
      <label class="md-nav__title" for="nav-2-5-9-23-5">
        <span class="md-nav__icon md-icon"></span>
        State Update Protocol
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/state_update/dialogues/" class="md-nav__link">
      Dialogues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/state_update/message/" class="md-nav__link">
      Message
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/protocols/state_update/serialization/" class="md-nav__link">
      Serialization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-24" type="checkbox" id="nav-2-5-9-24" >
    <label class="md-nav__link" for="nav-2-5-9-24">
      Registries
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Registries" data-md-level="4">
      <label class="md-nav__title" for="nav-2-5-9-24">
        <span class="md-nav__icon md-icon"></span>
        Registries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/registries/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/registries/filter/" class="md-nav__link">
      Filter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/registries/resources/" class="md-nav__link">
      Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-25" type="checkbox" id="nav-2-5-9-25" >
    <label class="md-nav__link" for="nav-2-5-9-25">
      Skills
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Skills" data-md-level="4">
      <label class="md-nav__title" for="nav-2-5-9-25">
        <span class="md-nav__icon md-icon"></span>
        Skills
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/skills/base/" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/skills/error/handlers/" class="md-nav__link">
      Error Skill
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/skills/behaviours/" class="md-nav__link">
      Behaviors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/skills/tasks/" class="md-nav__link">
      Task
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5-9-26" type="checkbox" id="nav-2-5-9-26" >
    <label class="md-nav__link" for="nav-2-5-9-26">
      Test Tools
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Test Tools" data-md-level="4">
      <label class="md-nav__title" for="nav-2-5-9-26">
        <span class="md-nav__icon md-icon"></span>
        Test Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/test_tools/generic/" class="md-nav__link">
      Generic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/test_tools/test_cases/" class="md-nav__link">
      Test Cases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/test_tools/test_skill/" class="md-nav__link">
      Test Skill
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../glossary/" class="md-nav__link">
      Glossary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../questions-and-answers/" class="md-nav__link">
      Q&A
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../simple-oef/" class="md-nav__link">
      Simple OEF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    <label class="md-nav__link" for="nav-3">
      Ledger
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Ledger" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Ledger
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" >
    <label class="md-nav__link" for="nav-3-2">
      Ledger v2
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Ledger v2" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        <span class="md-nav__icon md-icon"></span>
        Ledger v2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v2/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2-2" type="checkbox" id="nav-3-2-2" >
    <label class="md-nav__link" for="nav-3-2-2">
      Commandline Client
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Commandline Client" data-md-level="3">
      <label class="md-nav__title" for="nav-3-2-2">
        <span class="md-nav__icon md-icon"></span>
        Commandline Client
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v2/cli-introduction/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v2/cli-keys/" class="md-nav__link">
      Keys
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v2/cli-tokens/" class="md-nav__link">
      Tokens
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v2/block-explorer/" class="md-nav__link">
      Block Explorer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v2/building/" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v2/networks/" class="md-nav__link">
      Networks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v2/python-examples/" class="md-nav__link">
      Python Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3" >
    <label class="md-nav__link" for="nav-3-3">
      Ledger v1
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Ledger v1" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        <span class="md-nav__icon md-icon"></span>
        Ledger v1
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-2" type="checkbox" id="nav-3-3-2" >
    <label class="md-nav__link" for="nav-3-3-2">
      Using the ledger
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Using the ledger" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-2">
        <span class="md-nav__icon md-icon"></span>
        Using the ledger
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/walkthrough/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/walkthrough/creating-addresses/" class="md-nav__link">
      Creating addresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/walkthrough/testnet-tokens/" class="md-nav__link">
      Getting testnet tokens
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/walkthrough/transfers-and-balances/" class="md-nav__link">
      Making transfers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/walkthrough/smart-contracts/" class="md-nav__link">
      Deploying smart contracts
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-3" type="checkbox" id="nav-3-3-3" >
    <label class="md-nav__link" for="nav-3-3-3">
      Smart Contracts
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Smart Contracts" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-3">
        <span class="md-nav__icon md-icon"></span>
        Smart Contracts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/smart-contracts/smart-contract-intro/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/smart-contracts/static-dynamic/" class="md-nav__link">
      Static and dynamic contracts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-3-3" type="checkbox" id="nav-3-3-3-3" >
    <label class="md-nav__link" for="nav-3-3-3-3">
      Fetch.ai smart contracts
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Fetch.ai smart contracts" data-md-level="4">
      <label class="md-nav__title" for="nav-3-3-3-3">
        <span class="md-nav__icon md-icon"></span>
        Fetch.ai smart contracts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/smart-contracts/etch-smart-contracts/" class="md-nav__link">
      Smart contracts in Etch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/smart-contracts/pipenv/" class="md-nav__link">
      Development environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/smart-contracts/executing-smart-contract-code/" class="md-nav__link">
      Executing smart contracts
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-3-4" type="checkbox" id="nav-3-3-3-4" >
    <label class="md-nav__link" for="nav-3-3-3-4">
      Synergetic contracts
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Synergetic contracts" data-md-level="4">
      <label class="md-nav__title" for="nav-3-3-3-4">
        <span class="md-nav__icon md-icon"></span>
        Synergetic contracts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/smart-contracts/synergetic/" class="md-nav__link">
      Synergetic contracts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/smart-contracts/executing-synergetic-code/" class="md-nav__link">
      Executing synergetic contracts
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/smart-contracts/memory/" class="md-nav__link">
      Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/smart-contracts/fees/" class="md-nav__link">
      Fees
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-4" type="checkbox" id="nav-3-3-4" >
    <label class="md-nav__link" for="nav-3-3-4">
      Machine Learning library
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Machine Learning library" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-4">
        <span class="md-nav__icon md-icon"></span>
        Machine Learning library
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/machine-learning/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/machine-learning/library-architecture/" class="md-nav__link">
      Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/machine-learning/getting-started/" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/machine-learning/smart-contract-example/" class="md-nav__link">
      AI in smart contracts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/machine-learning/synergetic-contract-example/" class="md-nav__link">
      AI in synergetic contracts
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/maths-lib-overview/" class="md-nav__link">
      Maths library
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-6" type="checkbox" id="nav-3-3-6" >
    <label class="md-nav__link" for="nav-3-3-6">
      Python API
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Python API" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-6">
        <span class="md-nav__icon md-icon"></span>
        Python API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/python-ledger-api/python-api-install/" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-6-2" type="checkbox" id="nav-3-3-6-2" >
    <label class="md-nav__link" for="nav-3-3-6-2">
      Examples
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Examples" data-md-level="4">
      <label class="md-nav__title" for="nav-3-3-6-2">
        <span class="md-nav__icon md-icon"></span>
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/python-ledger-api/examples/block-number/" class="md-nav__link">
      Block Number
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-7" type="checkbox" id="nav-3-3-7" >
    <label class="md-nav__link" for="nav-3-3-7">
      Etch Language
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Etch Language" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-7">
        <span class="md-nav__icon md-icon"></span>
        Etch Language
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-7-2" type="checkbox" id="nav-3-3-7-2" >
    <label class="md-nav__link" for="nav-3-3-7-2">
      Usage
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Usage" data-md-level="4">
      <label class="md-nav__title" for="nav-3-3-7-2">
        <span class="md-nav__icon md-icon"></span>
        Usage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/getstarted/" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/debug/" class="md-nav__link">
      Debugging
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-7-3" type="checkbox" id="nav-3-3-7-3" >
    <label class="md-nav__link" for="nav-3-3-7-3">
      The Basics
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="The Basics" data-md-level="4">
      <label class="md-nav__title" for="nav-3-3-7-3">
        <span class="md-nav__icon md-icon"></span>
        The Basics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/syntax/" class="md-nav__link">
      Syntax
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/variables/" class="md-nav__link">
      Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/operators/" class="md-nav__link">
      Operators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/logic/" class="md-nav__link">
      Logical operators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/control-flow/" class="md-nav__link">
      Control flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/strings/" class="md-nav__link">
      Strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/arrays/" class="md-nav__link">
      Arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/functions/" class="md-nav__link">
      Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-7-3-9" type="checkbox" id="nav-3-3-7-3-9" >
    <label class="md-nav__link" for="nav-3-3-7-3-9">
      Function Annotations
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Function Annotations" data-md-level="5">
      <label class="md-nav__title" for="nav-3-3-7-3-9">
        <span class="md-nav__icon md-icon"></span>
        Function Annotations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/sc-annotations/" class="md-nav__link">
      Smart contract annotations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/syn-annotations/" class="md-nav__link">
      Synergetic contract annotations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/error-checking/" class="md-nav__link">
      Error checking
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-7-4" type="checkbox" id="nav-3-3-7-4" >
    <label class="md-nav__link" for="nav-3-3-7-4">
      Fetch Ledger Types
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Fetch Ledger Types" data-md-level="4">
      <label class="md-nav__title" for="nav-3-3-7-4">
        <span class="md-nav__icon md-icon"></span>
        Fetch Ledger Types
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/persistent-globals/" class="md-nav__link">
      Persistent globals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/states/" class="md-nav__link">
      State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/sharded-state/" class="md-nav__link">
      ShardedState
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/addresses/" class="md-nav__link">
      Address
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/crypto/" class="md-nav__link">
      Cryptographic functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/context/" class="md-nav__link">
      Context
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/transaction/" class="md-nav__link">
      Transaction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/balance-transfer/" class="md-nav__link">
      Balance and Transfer
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-7-5" type="checkbox" id="nav-3-3-7-5" >
    <label class="md-nav__link" for="nav-3-3-7-5">
      Mathematics
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Mathematics" data-md-level="4">
      <label class="md-nav__title" for="nav-3-3-7-5">
        <span class="md-nav__icon md-icon"></span>
        Mathematics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/maths-functions/" class="md-nav__link">
      Maths functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/tensor/" class="md-nav__link">
      Tensor
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-7-6" type="checkbox" id="nav-3-3-7-6" >
    <label class="md-nav__link" for="nav-3-3-7-6">
      Machine Learning
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Machine Learning" data-md-level="4">
      <label class="md-nav__title" for="nav-3-3-7-6">
        <span class="md-nav__icon md-icon"></span>
        Machine Learning
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/model/" class="md-nav__link">
      Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/graph/" class="md-nav__link">
      Graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/data-loaders/" class="md-nav__link">
      DataLoader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/optimiser/" class="md-nav__link">
      Optimiser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/scaler/" class="md-nav__link">
      Scaler
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-7-7" type="checkbox" id="nav-3-3-7-7" >
    <label class="md-nav__link" for="nav-3-3-7-7">
      Examples
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Examples" data-md-level="4">
      <label class="md-nav__title" for="nav-3-3-7-7">
        <span class="md-nav__icon md-icon"></span>
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/examples/fetch-logo/" class="md-nav__link">
      Fetch logo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/examples/mandelbrot/" class="md-nav__link">
      Mandelbrot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/examples/searching-algorithms/" class="md-nav__link">
      Searching algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/examples/sorting-algorithms/" class="md-nav__link">
      Sorting algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/etch-language/examples/dft/" class="md-nav__link">
      Discrete Fourier Transformation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-8" type="checkbox" id="nav-3-3-8" >
    <label class="md-nav__link" for="nav-3-3-8">
      Deploying nodes
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Deploying nodes" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-8">
        <span class="md-nav__icon md-icon"></span>
        Deploying nodes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-8-1" type="checkbox" id="nav-3-3-8-1" >
    <label class="md-nav__link" for="nav-3-3-8-1">
      Building the code
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Building the code" data-md-level="4">
      <label class="md-nav__title" for="nav-3-3-8-1">
        <span class="md-nav__icon md-icon"></span>
        Building the code
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/installation/installation-mac/" class="md-nav__link">
      MacOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/installation/installation-ubuntu/" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/installation/installation-redhat/" class="md-nav__link">
      Redhat
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/running-a-constellation/" class="md-nav__link">
      Running a node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ledger_v1/architecture/" class="md-nav__link">
      Architecture
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    <label class="md-nav__link" for="nav-4">
      Incentivized Testnets
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Incentivized Testnets" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Incentivized Testnets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../i_nets/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../i_nets/quickstart-aw1/" class="md-nav__link">
      Agent World 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../i_nets/quickstart-aw2/" class="md-nav__link">
      Agent World 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../i_nets/quickstart-aw3/" class="md-nav__link">
      Agent World 3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
    <label class="md-nav__link" for="nav-5">
      Bounty
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Bounty" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Bounty
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../bounty/aea-docs-bounty/" class="md-nav__link">
      AEA Docs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependencies-required" class="md-nav__link">
    Dependencies (Required)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference-optional" class="md-nav__link">
    Reference (Optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simplification-step" class="md-nav__link">
    Simplification step
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generic-seller-aea" class="md-nav__link">
    Generic Seller AEA
  </a>
  
    <nav class="md-nav" aria-label="Generic Seller AEA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-aea" class="md-nav__link">
    Step 1: Create the AEA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-create-the-behaviour" class="md-nav__link">
    Step 2: Create the behaviour
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-create-the-handler" class="md-nav__link">
    Step 3: Create the handler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-create-the-strategy" class="md-nav__link">
    Step 4: Create the strategy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-create-the-dialogues" class="md-nav__link">
    Step 5: Create the dialogues
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-update-the-yaml-files" class="md-nav__link">
    Step 6: Update the YAML files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generic-buyer-aea" class="md-nav__link">
    Generic Buyer AEA
  </a>
  
    <nav class="md-nav" aria-label="Generic Buyer AEA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-aea_1" class="md-nav__link">
    Step 1: Create the AEA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-create-the-behaviour_1" class="md-nav__link">
    Step 2: Create the behaviour
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-create-the-handler_1" class="md-nav__link">
    Step 3: Create the handler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-create-the-strategy_1" class="md-nav__link">
    Step 4: Create the strategy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-create-the-dialogues_1" class="md-nav__link">
    Step 5: Create the dialogues
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-update-the-yaml-files_1" class="md-nav__link">
    Step 6: Update the YAML files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-aeas" class="md-nav__link">
    Run the AEAs
  </a>
  
    <nav class="md-nav" aria-label="Run the AEAs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-private-keys" class="md-nav__link">
    Create private keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-the-aea-configs" class="md-nav__link">
    Update the AEA configs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fund-the-buyer-aea" class="md-nav__link">
    Fund the buyer AEA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-seller-aea" class="md-nav__link">
    Run seller AEA
  </a>
  
    <nav class="md-nav" aria-label="Run seller AEA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-buyer-aea" class="md-nav__link">
    Run buyer AEA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete-the-aeas" class="md-nav__link">
    Delete the AEAs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next steps
  </a>
  
    <nav class="md-nav" aria-label="Next steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommended" class="md-nav__link">
    Recommended
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/fetchai/docs/edit/master/docs/aea/generic-skills-step-by-step.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Trade between two AEAs</h1>
                
                <p>This guide is a step-by-step introduction to building an AEA that represents static, and dynamic data to be advertised on the <a href="../oef-ledger">Open Economic Framework</a>.</p>
<p>If you simply want to run the resulting AEAs <a href="../generic-skills">go here</a>.</p>
<!-- ## Hardware Requirements (Optional)

To follow this tutorial to completion you will need:

 - Raspberry Pi 4

 - Mini SD card

 - Thermometer sensor

 - AEA Framework

The AEA will live inside the Raspberry Pi and will read the data from a sensor. Then it will connect to the <a href="../oef-ledger">OEF search and communication networks</a> and will identify itself as a seller of that data.

If you simply want to follow the software part of the guide then you only require the dependencies listed in the <a href="../generic-skills-step-by-step/#dependencies">Dependencies</a> section.

### Setup the environment (Optional)

You can follow the guide <a href="../raspberry-set-up"> here </a> in order to setup your environment and prepare your Raspberry Pi.

Once you setup your Raspberry Pi, open a terminal and navigate to `/etc/udev/rules.d/`. Create a new file there  (I named mine `99-hidraw-permissions.rules`)
<div class="highlight"><pre><span></span><code>sudo nano <span class="m">99</span>-hidraw-permissions.rules
</code></pre></div>
and add the following inside the file:
<div class="highlight"><pre><span></span><code><span class="nv">KERNEL</span><span class="o">==</span><span class="s2">&quot;hidraw*&quot;</span>, <span class="nv">SUBSYSTEM</span><span class="o">==</span><span class="s2">&quot;hidraw&quot;</span>, <span class="nv">MODE</span><span class="o">=</span><span class="s2">&quot;0664&quot;</span>, <span class="nv">GROUP</span><span class="o">=</span><span class="s2">&quot;plugdev&quot;</span>
</code></pre></div>
this assigns all devices coming out of the hidraw subsystem in the kernel to the group `plugdev` and sets the permissions to `r/w r/w r` (for root [the default owner], plugdev, and everyone else respectively). -->

<h2 id="dependencies-required">Dependencies (Required)</h2>
<p>Follow the <a href="../quickstart/#preliminaries">Preliminaries</a> and <a href="../quickstart/#installation">Installation</a> sections from the AEA quick start.</p>
<h2 id="reference-optional">Reference (Optional)</h2>
<p>This step-by-step guide recreates two AEAs already developed by Fetch.ai. You can get the finished AEAs to compare your code against by following the next steps:</p>
<div class="highlight"><pre><span></span><code>aea fetch fetchai/generic_seller:0.15.0
<span class="nb">cd</span> generic_seller
aea eject skill fetchai/generic_seller:0.17.0
<span class="nb">cd</span> ..
</code></pre></div>
<div class="highlight"><pre><span></span><code>aea fetch fetchai/generic_buyer:0.16.0
<span class="nb">cd</span> generic_buyer
aea eject skill fetchai/generic_buyer:0.17.0
<span class="nb">cd</span> ..
</code></pre></div>
<h2 id="simplification-step">Simplification step</h2>
<p>To keep file paths consistent with the reference code, we suggest you initialize your local author as <code>fetchai</code> for the purpose of this demo only:</p>
<div class="highlight"><pre><span></span><code>aea init --reset --local --author fetchai
</code></pre></div>
<h2 id="generic-seller-aea">Generic Seller AEA</h2>
<h3 id="step-1-create-the-aea">Step 1: Create the AEA</h3>
<p>Create a new AEA by typing the following command in the terminal:
<div class="highlight"><pre><span></span><code>aea create my_generic_seller
<span class="nb">cd</span> my_generic_seller
</code></pre></div>
Our newly created AEA is inside the current working directory. Lets create our new skill that will handle the sale of data. Type the following command:
<div class="highlight"><pre><span></span><code>aea scaffold skill generic_seller
</code></pre></div></p>
<p>This command will create the correct structure for a new skill inside our AEA project You can locate the newly created skill inside the skills folder (<code>my_generic_seller/skills/generic_seller/</code>) and it must contain the following files:</p>
<ul>
<li><code>__init__.py</code></li>
<li><code>behaviours.py</code></li>
<li><code>handlers.py</code></li>
<li><code>my_model.py</code></li>
<li><code>skills.yaml</code></li>
</ul>
<h3 id="step-2-create-the-behaviour">Step 2: Create the behaviour</h3>
<p>A <a href="../api/skills/base#behaviour-objects"><code>Behaviour</code></a> class contains the business logic specific to actions initiated by the AEA rather than reactions to other events.</p>
<p>Open the <code>behaviours.py</code> file (<code>my_generic_seller/skills/generic_seller/behaviours.py</code>) and add the following code (replacing the stub code already present in the file):</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">cast</span>

<span class="kn">from</span> <span class="nn">aea.skills.behaviours</span> <span class="kn">import</span> <span class="n">TickerBehaviour</span>

<span class="kn">from</span> <span class="nn">packages.fetchai.connections.ledger.base</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CONNECTION_ID</span> <span class="k">as</span> <span class="n">LEDGER_CONNECTION_PUBLIC_ID</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.ledger_api.message</span> <span class="kn">import</span> <span class="n">LedgerApiMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.oef_search.message</span> <span class="kn">import</span> <span class="n">OefSearchMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.skills.generic_seller.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">LedgerApiDialogues</span><span class="p">,</span>
    <span class="n">OefSearchDialogues</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.skills.generic_seller.strategy</span> <span class="kn">import</span> <span class="n">GenericStrategy</span>


<span class="n">DEFAULT_SERVICES_INTERVAL</span> <span class="o">=</span> <span class="mf">60.0</span>
<span class="n">LEDGER_API_ADDRESS</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">LEDGER_CONNECTION_PUBLIC_ID</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">GenericServiceRegistrationBehaviour</span><span class="p">(</span><span class="n">TickerBehaviour</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class implements a behaviour.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the behaviour.&quot;&quot;&quot;</span>
        <span class="n">services_interval</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span>
            <span class="s2">&quot;services_interval&quot;</span><span class="p">,</span> <span class="n">DEFAULT_SERVICES_INTERVAL</span>
        <span class="p">)</span>  <span class="c1"># type: int</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tick_interval</span><span class="o">=</span><span class="n">services_interval</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the setup.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strategy</span><span class="o">.</span><span class="n">is_ledger_tx</span><span class="p">:</span>
            <span class="n">ledger_api_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">LedgerApiDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">ledger_api_dialogues</span>
            <span class="p">)</span>
            <span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ledger_api_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">counterparty</span><span class="o">=</span><span class="n">LEDGER_API_ADDRESS</span><span class="p">,</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">GET_BALANCE</span><span class="p">,</span>
                <span class="n">ledger_id</span><span class="o">=</span><span class="n">strategy</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">,</span>
                <span class="n">address</span><span class="o">=</span><span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_addresses</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">strategy</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">)),</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">ledger_api_msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_register_agent</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_register_service</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">act</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the act.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the task teardown.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unregister_service</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unregister_agent</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_register_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register the agent&#39;s location.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get_location_description</span><span class="p">()</span>
        <span class="n">oef_search_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">OefSearchDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">oef_search_dialogues</span>
        <span class="p">)</span>
        <span class="n">oef_search_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">oef_search_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">counterparty</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">search_service_address</span><span class="p">,</span>
            <span class="n">performative</span><span class="o">=</span><span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">REGISTER_SERVICE</span><span class="p">,</span>
            <span class="n">service_description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">oef_search_msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;registering agent on SOEF.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_register_service</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register the agent&#39;s service.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get_register_service_description</span><span class="p">()</span>
        <span class="n">oef_search_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">OefSearchDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">oef_search_dialogues</span>
        <span class="p">)</span>
        <span class="n">oef_search_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">oef_search_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">counterparty</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">search_service_address</span><span class="p">,</span>
            <span class="n">performative</span><span class="o">=</span><span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">REGISTER_SERVICE</span><span class="p">,</span>
            <span class="n">service_description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">oef_search_msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;registering service on SOEF.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_unregister_service</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unregister service from the SOEF.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get_unregister_service_description</span><span class="p">()</span>
        <span class="n">oef_search_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">OefSearchDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">oef_search_dialogues</span>
        <span class="p">)</span>
        <span class="n">oef_search_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">oef_search_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">counterparty</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">search_service_address</span><span class="p">,</span>
            <span class="n">performative</span><span class="o">=</span><span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">UNREGISTER_SERVICE</span><span class="p">,</span>
            <span class="n">service_description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">oef_search_msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;unregistering service from SOEF.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_unregister_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unregister agent from the SOEF.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get_location_description</span><span class="p">()</span>
        <span class="n">oef_search_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">OefSearchDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">oef_search_dialogues</span>
        <span class="p">)</span>
        <span class="n">oef_search_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">oef_search_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">counterparty</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">search_service_address</span><span class="p">,</span>
            <span class="n">performative</span><span class="o">=</span><span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">UNREGISTER_SERVICE</span><span class="p">,</span>
            <span class="n">service_description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">oef_search_msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;unregistering agent from SOEF.&quot;</span><span class="p">)</span>
</code></pre></div>
<p>This <a href="../api/skills/behaviours#tickerbehaviour-objects"><code>TickerBehaviour</code></a> registers and de-register our AEAs service on the <a href="../simple-oef">SOEF search node</a> at regular tick intervals (here 60 seconds). By registering, the AEA becomes discoverable to possible clients.</p>
<p>The act method unregisters and registers the AEA to the <a href="../simple-oef">SOEF search node</a> on each tick. Finally, the teardown method unregisters the AEA and reports your balances.</p>
<p>At setup we are sending a message to the ledger connection to check the account balance for the AEA's address on the configured ledger.</p>
<h3 id="step-3-create-the-handler">Step 3: Create the handler</h3>
<p>So far, we have tasked the AEA with sending register/unregister requests to the <a href="../simple-oef">SOEF search node</a>. However, we have at present no way of handling the responses sent to the AEA by the <a href="../simple-oef">SOEF search node</a> or messages sent from any other AEA.</p>
<p>We have to specify the logic to negotiate with another AEA based on the strategy we want our AEA to follow. The following diagram illustrates the negotiation flow, up to the agreement between a seller_AEA and a buyer_AEA.</p>
<div class="mermaid">
    sequenceDiagram
        participant Search
        participant Buyer_AEA
        participant Seller_AEA
        participant Blockchain

        activate Buyer_AEA
        activate Search
        activate Seller_AEA
        activate Blockchain

        Seller_AEA->>Search: register_service
        Buyer_AEA->>Search: search
        Search-->>Buyer_AEA: list_of_agents
        Buyer_AEA->>Seller_AEA: call_for_proposal
        Seller_AEA->>Buyer_AEA: propose
        Buyer_AEA->>Seller_AEA: accept
        Seller_AEA->>Buyer_AEA: match_accept
        loop Once with LedgerConnection
            Buyer_AEA->>Buyer_AEA: Get raw transaction from ledger api
        end
        loop Once with DecisionMaker
            Buyer_AEA->>Buyer_AEA: Get signed transaction from decision maker
        end
        loop Once with LedgerConnection
            Buyer_AEA->>Buyer_AEA: Send transaction and get digest from ledger api
            Buyer_AEA->>Blockchain: transfer_funds
        end
        Buyer_AEA->>Seller_AEA: send_transaction_digest
        Seller_AEA->>Blockchain: check_transaction_status
        Seller_AEA->>Buyer_AEA: send_data

        deactivate Buyer_AEA
        deactivate Search
        deactivate Seller_AEA
        deactivate Blockchain

</div>

<p>In the context of our generic use-case, the <code>my_generic_seller</code> AEA is the seller.</p>
<p>Let us now implement a <a href="../api/skills/base#handler-objects"><code>Handler</code></a> to deal with the incoming messages. Open the <code>handlers.py</code> file (<code>my_generic_seller/skills/generic_seller/handlers.py</code>) and add the following code (replacing the stub code already present in the file):</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">cast</span>

<span class="kn">from</span> <span class="nn">aea.configurations.base</span> <span class="kn">import</span> <span class="n">PublicId</span>
<span class="kn">from</span> <span class="nn">aea.crypto.ledger_apis</span> <span class="kn">import</span> <span class="n">LedgerApis</span>
<span class="kn">from</span> <span class="nn">aea.helpers.transaction.base</span> <span class="kn">import</span> <span class="n">TransactionDigest</span>
<span class="kn">from</span> <span class="nn">aea.protocols.base</span> <span class="kn">import</span> <span class="n">Message</span>
<span class="kn">from</span> <span class="nn">aea.skills.base</span> <span class="kn">import</span> <span class="n">Handler</span>

<span class="kn">from</span> <span class="nn">packages.fetchai.connections.ledger.base</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CONNECTION_ID</span> <span class="k">as</span> <span class="n">LEDGER_CONNECTION_PUBLIC_ID</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.default.message</span> <span class="kn">import</span> <span class="n">DefaultMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.fipa.message</span> <span class="kn">import</span> <span class="n">FipaMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.ledger_api.message</span> <span class="kn">import</span> <span class="n">LedgerApiMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.oef_search.message</span> <span class="kn">import</span> <span class="n">OefSearchMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.skills.generic_seller.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DefaultDialogues</span><span class="p">,</span>
    <span class="n">FipaDialogue</span><span class="p">,</span>
    <span class="n">FipaDialogues</span><span class="p">,</span>
    <span class="n">LedgerApiDialogue</span><span class="p">,</span>
    <span class="n">LedgerApiDialogues</span><span class="p">,</span>
    <span class="n">OefSearchDialogue</span><span class="p">,</span>
    <span class="n">OefSearchDialogues</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.skills.generic_seller.strategy</span> <span class="kn">import</span> <span class="n">GenericStrategy</span>


<span class="n">LEDGER_API_ADDRESS</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">LEDGER_CONNECTION_PUBLIC_ID</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">GenericFipaHandler</span><span class="p">(</span><span class="n">Handler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class implements a FIPA handler.&quot;&quot;&quot;</span>

    <span class="n">SUPPORTED_PROTOCOL</span> <span class="o">=</span> <span class="n">FipaMessage</span><span class="o">.</span><span class="n">protocol_id</span>  <span class="c1"># type: Optional[PublicId]</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Implement the setup for the handler.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the reaction to a message.</span>

<span class="sd">        :param message: the message</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fipa_msg</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">FipaMessage</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

        <span class="c1"># recover dialogue</span>
        <span class="n">fipa_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">FipaDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fipa_dialogues</span><span class="p">)</span>
        <span class="n">fipa_dialogue</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">FipaDialogue</span><span class="p">,</span> <span class="n">fipa_dialogues</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">fipa_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_unidentified_dialogue</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># handle message</span>
        <span class="k">if</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">performative</span> <span class="o">==</span> <span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">CFP</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_cfp</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">performative</span> <span class="o">==</span> <span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">DECLINE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_decline</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">,</span> <span class="n">fipa_dialogues</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">performative</span> <span class="o">==</span> <span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">ACCEPT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_accept</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">performative</span> <span class="o">==</span> <span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">INFORM</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_inform</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_invalid</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the handler teardown.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div>
The code above is logic for handling <code>FipaMessages</code> received by the <code>my_generic_seller</code> AEA. We use <code>FipaDialogues</code> (more on this below in <a href="../generic-skills-step-by-step/#step-5-create-the-dialogues">this</a> section) to keep track of the dialogue state between the <code>my_generic_seller</code> AEA and the <code>my_generic_buyer</code> AEA.</p>
<p>First, we check if the message is registered to an existing dialogue or if we have to create a new dialogue. The second part matches messages with their handler based on the message's performative. We are going to implement each case in a different function.</p>
<p>Below the unused <code>teardown</code> function, we continue by adding the following code:</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">_handle_unidentified_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="p">:</span> <span class="n">FipaMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an unidentified dialogue.</span>

<span class="sd">        :param fipa_msg: the message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received invalid fipa message=</span><span class="si">{}</span><span class="s2">, unidentified dialogue.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">default_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">DefaultDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">default_dialogues</span><span class="p">)</span>
        <span class="n">default_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">default_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">counterparty</span><span class="o">=</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span>
            <span class="n">performative</span><span class="o">=</span><span class="n">DefaultMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
            <span class="n">error_code</span><span class="o">=</span><span class="n">DefaultMessage</span><span class="o">.</span><span class="n">ErrorCode</span><span class="o">.</span><span class="n">INVALID_DIALOGUE</span><span class="p">,</span>
            <span class="n">error_msg</span><span class="o">=</span><span class="s2">&quot;Invalid dialogue.&quot;</span><span class="p">,</span>
            <span class="n">error_data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fipa_message&quot;</span><span class="p">:</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">encode</span><span class="p">()},</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">default_msg</span><span class="p">)</span>
</code></pre></div>
<p>The above code handles an unidentified dialogue by responding to the sender with a <code>DefaultMessage</code> containing the appropriate error information.</p>
<p>The next code block handles the <code>CFP</code> message, paste the code below the <code>_handle_unidentified_dialogue</code> function:</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">_handle_cfp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="p">:</span> <span class="n">FipaMessage</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the CFP.</span>

<span class="sd">        If the CFP matches the supplied services then send a PROPOSE, otherwise send a DECLINE.</span>

<span class="sd">        :param fipa_msg: the message</span>
<span class="sd">        :param fipa_dialogue: the dialogue object</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received CFP from sender=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
        <span class="p">)</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strategy</span><span class="o">.</span><span class="n">is_matching_supply</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">query</span><span class="p">):</span>
            <span class="n">proposal</span><span class="p">,</span> <span class="n">terms</span><span class="p">,</span> <span class="n">data_for_sale</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">generate_proposal_terms_and_data</span><span class="p">(</span>
                <span class="n">fipa_msg</span><span class="o">.</span><span class="n">query</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span>
            <span class="p">)</span>
            <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">data_for_sale</span> <span class="o">=</span> <span class="n">data_for_sale</span>
            <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">terms</span> <span class="o">=</span> <span class="n">terms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;sending a PROPOSE with proposal=</span><span class="si">{}</span><span class="s2"> to sender=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">proposal_msg</span> <span class="o">=</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">PROPOSE</span><span class="p">,</span>
                <span class="n">target_message</span><span class="o">=</span><span class="n">fipa_msg</span><span class="p">,</span>
                <span class="n">proposal</span><span class="o">=</span><span class="n">proposal</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">proposal_msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;declined the CFP from sender=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
            <span class="p">)</span>
            <span class="n">decline_msg</span> <span class="o">=</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">DECLINE</span><span class="p">,</span> <span class="n">target_message</span><span class="o">=</span><span class="n">fipa_msg</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">decline_msg</span><span class="p">)</span>
</code></pre></div>
<p>The above code will respond with a <code>PROPOSE</code> message to the buyer if the CFP matches the supplied services and our strategy otherwise it will respond with a <code>DECLINE</code> message.</p>
<p>The next code-block  handles the decline message we receive from the buyer. Add the following code below the <code>_handle_cfp</code>function:</p>
<p><div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">_handle_decline</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fipa_msg</span><span class="p">:</span> <span class="n">FipaMessage</span><span class="p">,</span>
        <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span><span class="p">,</span>
        <span class="n">fipa_dialogues</span><span class="p">:</span> <span class="n">FipaDialogues</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the DECLINE.</span>

<span class="sd">        Close the dialogue.</span>

<span class="sd">        :param fipa_msg: the message</span>
<span class="sd">        :param fipa_dialogue: the dialogue object</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received DECLINE from sender=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
        <span class="p">)</span>
        <span class="n">fipa_dialogues</span><span class="o">.</span><span class="n">dialogue_stats</span><span class="o">.</span><span class="n">add_dialogue_endstate</span><span class="p">(</span>
            <span class="n">FipaDialogue</span><span class="o">.</span><span class="n">EndState</span><span class="o">.</span><span class="n">DECLINED_PROPOSE</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">is_self_initiated</span>
        <span class="p">)</span>
</code></pre></div>
If we receive a decline message from the buyer we close the dialogue and terminate this conversation with the <code>my_generic_buyer</code>.</p>
<p>Alternatively, we might receive an <code>ACCEPT</code> message. In order to handle this option add the following code below the <code>_handle_decline</code> function:</p>
<p><div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">_handle_accept</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="p">:</span> <span class="n">FipaMessage</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the ACCEPT.</span>

<span class="sd">        Respond with a MATCH_ACCEPT_W_INFORM which contains the address to send the funds to.</span>

<span class="sd">        :param fipa_msg: the message</span>
<span class="sd">        :param fipa_dialogue: the dialogue object</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received ACCEPT from sender=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
        <span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">sender_address</span><span class="p">}</span>
        <span class="n">match_accept_msg</span> <span class="o">=</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span>
            <span class="n">performative</span><span class="o">=</span><span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">MATCH_ACCEPT_W_INFORM</span><span class="p">,</span>
            <span class="n">target_message</span><span class="o">=</span><span class="n">fipa_msg</span><span class="p">,</span>
            <span class="n">info</span><span class="o">=</span><span class="n">info</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;sending MATCH_ACCEPT_W_INFORM to sender=</span><span class="si">{}</span><span class="s2"> with info=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:],</span> <span class="n">info</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">match_accept_msg</span><span class="p">)</span>
</code></pre></div>
When the <code>my_generic_buyer</code> accepts the <code>Proposal</code> we send it, and therefores sends us an <code>ACCEPT</code> message, we have to respond with another message (<code>MATCH_ACCEPT_W_INFORM</code> ) to inform the buyer about the address we would like it to send the funds to.</p>
<p>Lastly, we handle the <code>INFORM</code> message, which the buyer uses to inform us that it has sent the funds to the provided address. Add the following code:</p>
<p><div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">_handle_inform</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="p">:</span> <span class="n">FipaMessage</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the INFORM.</span>

<span class="sd">        If the INFORM message contains the transaction_digest then verify that it is settled, otherwise do nothing.</span>
<span class="sd">        If the transaction is settled, send the data, otherwise do nothing.</span>

<span class="sd">        :param fipa_msg: the message</span>
<span class="sd">        :param fipa_dialogue: the dialogue object</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received INFORM from sender=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
        <span class="p">)</span>

        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strategy</span><span class="o">.</span><span class="n">is_ledger_tx</span> <span class="ow">and</span> <span class="s2">&quot;transaction_digest&quot;</span> <span class="ow">in</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;checking whether transaction=</span><span class="si">{}</span><span class="s2"> has been received ...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">fipa_msg</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;transaction_digest&quot;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">ledger_api_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">LedgerApiDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">ledger_api_dialogues</span>
            <span class="p">)</span>
            <span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span> <span class="o">=</span> <span class="n">ledger_api_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">counterparty</span><span class="o">=</span><span class="n">LEDGER_API_ADDRESS</span><span class="p">,</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">GET_TRANSACTION_RECEIPT</span><span class="p">,</span>
                <span class="n">transaction_digest</span><span class="o">=</span><span class="n">TransactionDigest</span><span class="p">(</span>
                    <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;transaction_digest&quot;</span><span class="p">]</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">ledger_api_dialogue</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">LedgerApiDialogue</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">)</span>
            <span class="n">ledger_api_dialogue</span><span class="o">.</span><span class="n">associated_fipa_dialogue</span> <span class="o">=</span> <span class="n">fipa_dialogue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">ledger_api_msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">strategy</span><span class="o">.</span><span class="n">is_ledger_tx</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;did not receive transaction digest from sender=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">strategy</span><span class="o">.</span><span class="n">is_ledger_tx</span> <span class="ow">and</span> <span class="s2">&quot;Done&quot;</span> <span class="ow">in</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">inform_msg</span> <span class="o">=</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">INFORM</span><span class="p">,</span>
                <span class="n">target_message</span><span class="o">=</span><span class="n">fipa_msg</span><span class="p">,</span>
                <span class="n">info</span><span class="o">=</span><span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">data_for_sale</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">inform_msg</span><span class="p">)</span>
            <span class="n">fipa_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">FipaDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fipa_dialogues</span><span class="p">)</span>
            <span class="n">fipa_dialogues</span><span class="o">.</span><span class="n">dialogue_stats</span><span class="o">.</span><span class="n">add_dialogue_endstate</span><span class="p">(</span>
                <span class="n">FipaDialogue</span><span class="o">.</span><span class="n">EndState</span><span class="o">.</span><span class="n">SUCCESSFUL</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">is_self_initiated</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;transaction confirmed, sending data=</span><span class="si">{}</span><span class="s2"> to buyer=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">data_for_sale</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:],</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;did not receive transaction confirmation from sender=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
                <span class="p">)</span>
            <span class="p">)</span>
</code></pre></div>
We are checking the inform message. If it contains the transaction digest we verify that transaction matches the proposal that the buyer accepted. If the transaction is valid and we received the funds then we send the data to the buyer.  Otherwise we do not send the data.</p>
<p>The remaining handlers are as follows:
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">_handle_invalid</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="p">:</span> <span class="n">FipaMessage</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle a fipa message of invalid performative.</span>

<span class="sd">        :param fipa_msg: the message</span>
<span class="sd">        :param fipa_dialogue: the dialogue object</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;cannot handle fipa message of performative=</span><span class="si">{}</span><span class="s2"> in dialogue=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">fipa_msg</span><span class="o">.</span><span class="n">performative</span><span class="p">,</span> <span class="n">fipa_dialogue</span>
            <span class="p">)</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">GenericLedgerApiHandler</span><span class="p">(</span><span class="n">Handler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implement the ledger handler.&quot;&quot;&quot;</span>

    <span class="n">SUPPORTED_PROTOCOL</span> <span class="o">=</span> <span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">protocol_id</span>  <span class="c1"># type: Optional[PublicId]</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Implement the setup for the handler.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the reaction to a message.</span>

<span class="sd">        :param message: the message</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ledger_api_msg</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">LedgerApiMessage</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

        <span class="c1"># recover dialogue</span>
        <span class="n">ledger_api_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">LedgerApiDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">ledger_api_dialogues</span>
        <span class="p">)</span>
        <span class="n">ledger_api_dialogue</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">Optional</span><span class="p">[</span><span class="n">LedgerApiDialogue</span><span class="p">],</span> <span class="n">ledger_api_dialogues</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">ledger_api_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_unidentified_dialogue</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># handle message</span>
        <span class="k">if</span> <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">performative</span> <span class="ow">is</span> <span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">BALANCE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_balance</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">performative</span>
            <span class="ow">is</span> <span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">TRANSACTION_RECEIPT</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_transaction_receipt</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">performative</span> <span class="o">==</span> <span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">ERROR</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_error</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_invalid</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the handler teardown.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_handle_unidentified_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="p">:</span> <span class="n">LedgerApiMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an unidentified dialogue.</span>

<span class="sd">        :param msg: the message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received invalid ledger_api message=</span><span class="si">{}</span><span class="s2">, unidentified dialogue.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">ledger_api_msg</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="p">:</span> <span class="n">LedgerApiMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle a message of balance performative.</span>

<span class="sd">        :param ledger_api_message: the ledger api message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;starting balance on </span><span class="si">{}</span><span class="s2"> ledger=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_transaction_receipt</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="p">:</span> <span class="n">LedgerApiMessage</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">:</span> <span class="n">LedgerApiDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle a message of balance performative.</span>

<span class="sd">        :param ledger_api_message: the ledger api message</span>
<span class="sd">        :param ledger_api_dialogue: the ledger api dialogue</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fipa_dialogue</span> <span class="o">=</span> <span class="n">ledger_api_dialogue</span><span class="o">.</span><span class="n">associated_fipa_dialogue</span>
        <span class="n">is_settled</span> <span class="o">=</span> <span class="n">LedgerApis</span><span class="o">.</span><span class="n">is_transaction_settled</span><span class="p">(</span>
            <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">transaction_receipt</span><span class="o">.</span><span class="n">receipt</span>
        <span class="p">)</span>
        <span class="n">is_valid</span> <span class="o">=</span> <span class="n">LedgerApis</span><span class="o">.</span><span class="n">is_transaction_valid</span><span class="p">(</span>
            <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">,</span>
            <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">transaction_receipt</span><span class="o">.</span><span class="n">transaction</span><span class="p">,</span>
            <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">sender_address</span><span class="p">,</span>
            <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">counterparty_address</span><span class="p">,</span>
            <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">nonce</span><span class="p">,</span>
            <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">counterparty_payable_amount</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">is_settled</span> <span class="ow">and</span> <span class="n">is_valid</span><span class="p">:</span>
            <span class="n">last_message</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">Optional</span><span class="p">[</span><span class="n">FipaMessage</span><span class="p">],</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">last_incoming_message</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">last_message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot retrieve last fipa message.&quot;</span><span class="p">)</span>
            <span class="n">inform_msg</span> <span class="o">=</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">INFORM</span><span class="p">,</span>
                <span class="n">target_message</span><span class="o">=</span><span class="n">last_message</span><span class="p">,</span>
                <span class="n">info</span><span class="o">=</span><span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">data_for_sale</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">inform_msg</span><span class="p">)</span>
            <span class="n">fipa_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">FipaDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fipa_dialogues</span><span class="p">)</span>
            <span class="n">fipa_dialogues</span><span class="o">.</span><span class="n">dialogue_stats</span><span class="o">.</span><span class="n">add_dialogue_endstate</span><span class="p">(</span>
                <span class="n">FipaDialogue</span><span class="o">.</span><span class="n">EndState</span><span class="o">.</span><span class="n">SUCCESSFUL</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">is_self_initiated</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;transaction confirmed, sending data=</span><span class="si">{}</span><span class="s2"> to buyer=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">data_for_sale</span><span class="p">,</span> <span class="n">last_message</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:],</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;transaction_receipt=</span><span class="si">{}</span><span class="s2"> not settled or not valid, aborting&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">transaction_receipt</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_error</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="p">:</span> <span class="n">LedgerApiMessage</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">:</span> <span class="n">LedgerApiDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle a message of error performative.</span>

<span class="sd">        :param ledger_api_message: the ledger api message</span>
<span class="sd">        :param ledger_api_dialogue: the ledger api dialogue</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received ledger_api error message=</span><span class="si">{}</span><span class="s2"> in dialogue=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_invalid</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="p">:</span> <span class="n">LedgerApiMessage</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">:</span> <span class="n">LedgerApiDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle a message of invalid performative.</span>

<span class="sd">        :param ledger_api_message: the ledger api message</span>
<span class="sd">        :param ledger_api_dialogue: the ledger api dialogue</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;cannot handle ledger_api message of performative=</span><span class="si">{}</span><span class="s2"> in dialogue=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">performative</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">GenericOefSearchHandler</span><span class="p">(</span><span class="n">Handler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class implements an OEF search handler.&quot;&quot;&quot;</span>

    <span class="n">SUPPORTED_PROTOCOL</span> <span class="o">=</span> <span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">protocol_id</span>  <span class="c1"># type: Optional[PublicId]</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call to setup the handler.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the reaction to a message.</span>

<span class="sd">        :param message: the message</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oef_search_msg</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">OefSearchMessage</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

        <span class="c1"># recover dialogue</span>
        <span class="n">oef_search_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">OefSearchDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">oef_search_dialogues</span>
        <span class="p">)</span>
        <span class="n">oef_search_dialogue</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">Optional</span><span class="p">[</span><span class="n">OefSearchDialogue</span><span class="p">],</span> <span class="n">oef_search_dialogues</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">oef_search_msg</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">oef_search_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_unidentified_dialogue</span><span class="p">(</span><span class="n">oef_search_msg</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># handle message</span>
        <span class="k">if</span> <span class="n">oef_search_msg</span><span class="o">.</span><span class="n">performative</span> <span class="ow">is</span> <span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">OEF_ERROR</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_error</span><span class="p">(</span><span class="n">oef_search_msg</span><span class="p">,</span> <span class="n">oef_search_dialogue</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_invalid</span><span class="p">(</span><span class="n">oef_search_msg</span><span class="p">,</span> <span class="n">oef_search_dialogue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the handler teardown.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_handle_unidentified_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oef_search_msg</span><span class="p">:</span> <span class="n">OefSearchMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an unidentified dialogue.</span>

<span class="sd">        :param msg: the message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received invalid oef_search message=</span><span class="si">{}</span><span class="s2">, unidentified dialogue.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">oef_search_msg</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_error</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">oef_search_msg</span><span class="p">:</span> <span class="n">OefSearchMessage</span><span class="p">,</span> <span class="n">oef_search_dialogue</span><span class="p">:</span> <span class="n">OefSearchDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an oef search message.</span>

<span class="sd">        :param oef_search_msg: the oef search message</span>
<span class="sd">        :param oef_search_dialogue: the dialogue</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received oef_search error message=</span><span class="si">{}</span><span class="s2"> in dialogue=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">oef_search_msg</span><span class="p">,</span> <span class="n">oef_search_dialogue</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_invalid</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">oef_search_msg</span><span class="p">:</span> <span class="n">OefSearchMessage</span><span class="p">,</span> <span class="n">oef_search_dialogue</span><span class="p">:</span> <span class="n">OefSearchDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an oef search message.</span>

<span class="sd">        :param oef_search_msg: the oef search message</span>
<span class="sd">        :param oef_search_dialogue: the dialogue</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;cannot handle oef_search message of performative=</span><span class="si">{}</span><span class="s2"> in dialogue=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">oef_search_msg</span><span class="o">.</span><span class="n">performative</span><span class="p">,</span> <span class="n">oef_search_dialogue</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></p>
<p>The <code>GenericLedgerApiHandler</code> deals with <code>LedgerApiMessages</code> from the ledger connection. The <code>GenericOefSearchHandler</code> handles <code>OefSearchMessages</code> from the soef connection.</p>
<h3 id="step-4-create-the-strategy">Step 4: Create the strategy</h3>
<p>Next, we are going to create the strategy that we want our <code>my_generic_seller</code> AEA to follow. Rename the <code>my_model.py</code> file (<code>my_generic_seller/skills/generic_seller/my_model.py</code>) to <code>strategy.py</code> and copy and paste the following code (replacing the stub code already present in the file):</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">from</span> <span class="nn">aea.common</span> <span class="kn">import</span> <span class="n">Address</span>
<span class="kn">from</span> <span class="nn">aea.crypto.ledger_apis</span> <span class="kn">import</span> <span class="n">LedgerApis</span>
<span class="kn">from</span> <span class="nn">aea.exceptions</span> <span class="kn">import</span> <span class="n">enforce</span>
<span class="kn">from</span> <span class="nn">aea.helpers.search.generic</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AGENT_LOCATION_MODEL</span><span class="p">,</span>
    <span class="n">AGENT_REMOVE_SERVICE_MODEL</span><span class="p">,</span>
    <span class="n">AGENT_SET_SERVICE_MODEL</span><span class="p">,</span>
    <span class="n">SIMPLE_SERVICE_MODEL</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">aea.helpers.search.models</span> <span class="kn">import</span> <span class="n">Description</span><span class="p">,</span> <span class="n">Location</span><span class="p">,</span> <span class="n">Query</span>
<span class="kn">from</span> <span class="nn">aea.helpers.transaction.base</span> <span class="kn">import</span> <span class="n">Terms</span>
<span class="kn">from</span> <span class="nn">aea.skills.base</span> <span class="kn">import</span> <span class="n">Model</span>


<span class="n">DEFAULT_IS_LEDGER_TX</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">DEFAULT_UNIT_PRICE</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">DEFAULT_SERVICE_ID</span> <span class="o">=</span> <span class="s2">&quot;generic_service&quot;</span>

<span class="n">DEFAULT_LOCATION</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="mf">0.1270</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="mf">51.5194</span><span class="p">}</span>
<span class="n">DEFAULT_SERVICE_DATA</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;seller_service&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;generic_service&quot;</span><span class="p">}</span>

<span class="n">DEFAULT_HAS_DATA_SOURCE</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">DEFAULT_DATA_FOR_SALE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;some_generic_data_key&quot;</span><span class="p">:</span> <span class="s2">&quot;some_generic_data_value&quot;</span>
<span class="p">}</span>  <span class="c1"># type: Optional[Dict[str, Any]]</span>


<span class="k">class</span> <span class="nc">GenericStrategy</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class defines a strategy for the agent.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the strategy of the agent.</span>

<span class="sd">        :param register_as: determines whether the agent registers as seller, buyer or both</span>
<span class="sd">        :param search_for: determines whether the agent searches for sellers, buyers or both</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ledger_id</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ledger_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">currency_id</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;currency_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_ledger_tx</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;is_ledger_tx&quot;</span><span class="p">,</span> <span class="n">DEFAULT_IS_LEDGER_TX</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_unit_price</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;unit_price&quot;</span><span class="p">,</span> <span class="n">DEFAULT_UNIT_PRICE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_service_id</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;service_id&quot;</span><span class="p">,</span> <span class="n">DEFAULT_SERVICE_ID</span><span class="p">)</span>

        <span class="n">location</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="n">DEFAULT_LOCATION</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_agent_location</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="n">Location</span><span class="p">(</span>
                <span class="n">latitude</span><span class="o">=</span><span class="n">location</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">longitude</span><span class="o">=</span><span class="n">location</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_service_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;service_data&quot;</span><span class="p">,</span> <span class="n">DEFAULT_SERVICE_DATA</span><span class="p">)</span>
        <span class="n">enforce</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_service_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
            <span class="ow">and</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_service_data</span>
            <span class="ow">and</span> <span class="s2">&quot;value&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_service_data</span><span class="p">,</span>
            <span class="s2">&quot;service_data must contain keys `key` and `value`&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_remove_service_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_service_data</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_simple_service_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_service_data</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_service_data</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_has_data_source</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;has_data_source&quot;</span><span class="p">,</span> <span class="n">DEFAULT_HAS_DATA_SOURCE</span><span class="p">)</span>
        <span class="n">data_for_sale_ordered</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;data_for_sale&quot;</span><span class="p">,</span> <span class="n">DEFAULT_DATA_FOR_SALE</span><span class="p">)</span>
        <span class="n">data_for_sale</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">):</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data_for_sale_ordered</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ledger_id</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ledger_id</span> <span class="k">if</span> <span class="n">ledger_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">default_ledger_id</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">currency_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">currency_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">currency_denominations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ledger_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">enforce</span><span class="p">(</span>
                <span class="n">currency_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;Currency denomination for ledger_id=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ledger_id</span><span class="si">}</span><span class="s2"> not specified.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currency_id</span> <span class="o">=</span> <span class="n">currency_id</span>
        <span class="n">enforce</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_addresses</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ledger_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Wallet does not contain cryptos for provided ledger id.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_for_sale</span> <span class="o">=</span> <span class="n">data_for_sale</span>
</code></pre></div>
<p>We initialise the strategy class. We are trying to read the strategy variables from the yaml file. If this is not possible we specified some default values.</p>
<p>The following properties and methods deal with different aspects of the strategy. Add them under the initialization of the class:</p>
<div class="highlight"><pre><span></span><code>    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data_for_sale</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the data for sale.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_data_source</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_from_data_source</span><span class="p">()</span>  <span class="c1"># pragma: nocover</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_for_sale</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ledger_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the ledger id.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ledger_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_ledger_tx</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Check whether or not tx are settled on a ledger.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_ledger_tx</span>

    <span class="k">def</span> <span class="nf">get_location_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Description</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the location description.</span>

<span class="sd">        :return: a description of the agent&#39;s location</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">Description</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_agent_location</span><span class="p">,</span> <span class="n">data_model</span><span class="o">=</span><span class="n">AGENT_LOCATION_MODEL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">description</span>

    <span class="k">def</span> <span class="nf">get_register_service_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Description</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the register service description.</span>

<span class="sd">        :return: a description of the offered services</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">Description</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_service_data</span><span class="p">,</span> <span class="n">data_model</span><span class="o">=</span><span class="n">AGENT_SET_SERVICE_MODEL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">description</span>

    <span class="k">def</span> <span class="nf">get_service_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Description</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the simple service description.</span>

<span class="sd">        :return: a description of the offered services</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">Description</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_simple_service_data</span><span class="p">,</span> <span class="n">data_model</span><span class="o">=</span><span class="n">SIMPLE_SERVICE_MODEL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">description</span>

    <span class="k">def</span> <span class="nf">get_unregister_service_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Description</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the unregister service description.</span>

<span class="sd">        :return: a description of the to be removed service</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">Description</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_service_data</span><span class="p">,</span> <span class="n">data_model</span><span class="o">=</span><span class="n">AGENT_REMOVE_SERVICE_MODEL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">description</span>

    <span class="k">def</span> <span class="nf">is_matching_supply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">Query</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the query matches the supply.</span>

<span class="sd">        :param query: the query</span>
<span class="sd">        :return: bool indiciating whether matches or not</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">query</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_service_description</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">generate_proposal_terms_and_data</span><span class="p">(</span>  <span class="c1"># pylint: disable=unused-argument</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">Query</span><span class="p">,</span> <span class="n">counterparty_address</span><span class="p">:</span> <span class="n">Address</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Description</span><span class="p">,</span> <span class="n">Terms</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a proposal matching the query.</span>

<span class="sd">        :param query: the query</span>
<span class="sd">        :param counterparty_address: the counterparty of the proposal.</span>
<span class="sd">        :return: a tuple of proposal, terms and the weather data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_for_sale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_for_sale</span>
        <span class="n">sale_quantity</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_for_sale</span><span class="p">)</span>
        <span class="n">seller_address</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_addresses</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">]</span>
        <span class="n">total_price</span> <span class="o">=</span> <span class="n">sale_quantity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unit_price</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ledger_tx</span><span class="p">:</span>
            <span class="n">tx_nonce</span> <span class="o">=</span> <span class="n">LedgerApis</span><span class="o">.</span><span class="n">generate_tx_nonce</span><span class="p">(</span>
                <span class="n">identifier</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">,</span>
                <span class="n">seller</span><span class="o">=</span><span class="n">seller_address</span><span class="p">,</span>
                <span class="n">client</span><span class="o">=</span><span class="n">counterparty_address</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tx_nonce</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>  <span class="c1"># pragma: nocover</span>
        <span class="n">proposal</span> <span class="o">=</span> <span class="n">Description</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;ledger_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">,</span>
                <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="n">total_price</span><span class="p">,</span>
                <span class="s2">&quot;currency_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currency_id</span><span class="p">,</span>
                <span class="s2">&quot;service_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_service_id</span><span class="p">,</span>
                <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="n">sale_quantity</span><span class="p">,</span>
                <span class="s2">&quot;tx_nonce&quot;</span><span class="p">:</span> <span class="n">tx_nonce</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="n">Terms</span><span class="p">(</span>
            <span class="n">ledger_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">,</span>
            <span class="n">sender_address</span><span class="o">=</span><span class="n">seller_address</span><span class="p">,</span>
            <span class="n">counterparty_address</span><span class="o">=</span><span class="n">counterparty_address</span><span class="p">,</span>
            <span class="n">amount_by_currency_id</span><span class="o">=</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_currency_id</span><span class="p">:</span> <span class="n">total_price</span><span class="p">},</span>
            <span class="n">quantities_by_good_id</span><span class="o">=</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_service_id</span><span class="p">:</span> <span class="o">-</span><span class="n">sale_quantity</span><span class="p">},</span>
            <span class="n">is_sender_payable_tx_fee</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">nonce</span><span class="o">=</span><span class="n">tx_nonce</span><span class="p">,</span>
            <span class="n">fee_by_currency_id</span><span class="o">=</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_currency_id</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">proposal</span><span class="p">,</span> <span class="n">terms</span><span class="p">,</span> <span class="n">data_for_sale</span>

    <span class="k">def</span> <span class="nf">collect_from_data_source</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Implement the logic to communicate with the sensor.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
<p>Before the creation of the actual proposal, we have to check if the sale generates value for us or a loss. If it is a loss, we abort and warn the developer. The helper private function <code>collect_from_data_source</code>, is where we read data from our sensor or in case we do not have a sensor use some default data provided.</p>
<h3 id="step-5-create-the-dialogues">Step 5: Create the dialogues</h3>
<p>When we are negotiating with other AEAs we would like to keep track of the state of these negotiations. To this end we create a new file in the skill folder (<code>my_generic_seller/skills/generic_seller/</code>) and name it <code>dialogues.py</code>. Inside this file add the following code:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Type</span>

<span class="kn">from</span> <span class="nn">aea.common</span> <span class="kn">import</span> <span class="n">Address</span>
<span class="kn">from</span> <span class="nn">aea.exceptions</span> <span class="kn">import</span> <span class="n">AEAEnforceError</span><span class="p">,</span> <span class="n">enforce</span>
<span class="kn">from</span> <span class="nn">aea.helpers.transaction.base</span> <span class="kn">import</span> <span class="n">Terms</span>
<span class="kn">from</span> <span class="nn">aea.protocols.base</span> <span class="kn">import</span> <span class="n">Message</span>
<span class="kn">from</span> <span class="nn">aea.protocols.dialogue.base</span> <span class="kn">import</span> <span class="n">Dialogue</span> <span class="k">as</span> <span class="n">BaseDialogue</span>
<span class="kn">from</span> <span class="nn">aea.protocols.dialogue.base</span> <span class="kn">import</span> <span class="n">DialogueLabel</span> <span class="k">as</span> <span class="n">BaseDialogueLabel</span>
<span class="kn">from</span> <span class="nn">aea.skills.base</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.default.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DefaultDialogue</span> <span class="k">as</span> <span class="n">BaseDefaultDialogue</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.default.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DefaultDialogues</span> <span class="k">as</span> <span class="n">BaseDefaultDialogues</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.fipa.dialogues</span> <span class="kn">import</span> <span class="n">FipaDialogue</span> <span class="k">as</span> <span class="n">BaseFipaDialogue</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.fipa.dialogues</span> <span class="kn">import</span> <span class="n">FipaDialogues</span> <span class="k">as</span> <span class="n">BaseFipaDialogues</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.fipa.message</span> <span class="kn">import</span> <span class="n">FipaMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.ledger_api.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">LedgerApiDialogue</span> <span class="k">as</span> <span class="n">BaseLedgerApiDialogue</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.ledger_api.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">LedgerApiDialogues</span> <span class="k">as</span> <span class="n">BaseLedgerApiDialogues</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.ledger_api.message</span> <span class="kn">import</span> <span class="n">LedgerApiMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.oef_search.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">OefSearchDialogue</span> <span class="k">as</span> <span class="n">BaseOefSearchDialogue</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.oef_search.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">OefSearchDialogues</span> <span class="k">as</span> <span class="n">BaseOefSearchDialogues</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">DefaultDialogue</span> <span class="o">=</span> <span class="n">BaseDefaultDialogue</span>


<span class="k">class</span> <span class="nc">DefaultDialogues</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">BaseDefaultDialogues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogues class keeps track of all dialogues.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize dialogues.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Model</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">role_from_first_message</span><span class="p">(</span>  <span class="c1"># pylint: disable=unused-argument</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span> <span class="n">receiver_address</span><span class="p">:</span> <span class="n">Address</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Infer the role of the agent from an incoming/outgoing first message</span>

<span class="sd">            :param message: an incoming/outgoing first message</span>
<span class="sd">            :param receiver_address: the address of the receiving agent</span>
<span class="sd">            :return: The role of the agent</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">DefaultDialogue</span><span class="o">.</span><span class="n">Role</span><span class="o">.</span><span class="n">AGENT</span>

        <span class="n">BaseDefaultDialogues</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_address</span><span class="p">,</span>
            <span class="n">role_from_first_message</span><span class="o">=</span><span class="n">role_from_first_message</span><span class="p">,</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">FipaDialogue</span><span class="p">(</span><span class="n">BaseFipaDialogue</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogue class maintains state of a dialogue and manages it.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dialogue_label</span><span class="p">:</span> <span class="n">BaseDialogueLabel</span><span class="p">,</span>
        <span class="n">self_address</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
        <span class="n">role</span><span class="p">:</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span>
        <span class="n">message_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">FipaMessage</span><span class="p">]</span> <span class="o">=</span> <span class="n">FipaMessage</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a dialogue.</span>

<span class="sd">        :param dialogue_label: the identifier of the dialogue</span>
<span class="sd">        :param self_address: the address of the entity for whom this dialogue is maintained</span>
<span class="sd">        :param role: the role of the agent this dialogue is maintained for</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BaseFipaDialogue</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">dialogue_label</span><span class="o">=</span><span class="n">dialogue_label</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="n">self_address</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="n">role</span><span class="p">,</span>
            <span class="n">message_class</span><span class="o">=</span><span class="n">message_class</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_for_sale</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: Optional[Dict[str, str]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_terms</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: Optional[Terms]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">terms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Terms</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get terms.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_terms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AEAEnforceError</span><span class="p">(</span><span class="s2">&quot;Terms not set!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_terms</span>

    <span class="nd">@terms</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">terms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">terms</span><span class="p">:</span> <span class="n">Terms</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set terms.&quot;&quot;&quot;</span>
        <span class="n">enforce</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_terms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Terms already set!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_terms</span> <span class="o">=</span> <span class="n">terms</span>


<span class="k">class</span> <span class="nc">FipaDialogues</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">BaseFipaDialogues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogues class keeps track of all dialogues.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize dialogues.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Model</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">role_from_first_message</span><span class="p">(</span>  <span class="c1"># pylint: disable=unused-argument</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span> <span class="n">receiver_address</span><span class="p">:</span> <span class="n">Address</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Infer the role of the agent from an incoming/outgoing first message</span>

<span class="sd">            :param message: an incoming/outgoing first message</span>
<span class="sd">            :param receiver_address: the address of the receiving agent</span>
<span class="sd">            :return: The role of the agent</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">FipaDialogue</span><span class="o">.</span><span class="n">Role</span><span class="o">.</span><span class="n">SELLER</span>

        <span class="n">BaseFipaDialogues</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_address</span><span class="p">,</span>
            <span class="n">role_from_first_message</span><span class="o">=</span><span class="n">role_from_first_message</span><span class="p">,</span>
            <span class="n">dialogue_class</span><span class="o">=</span><span class="n">FipaDialogue</span><span class="p">,</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">LedgerApiDialogue</span><span class="p">(</span><span class="n">BaseLedgerApiDialogue</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogue class maintains state of a dialogue and manages it.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dialogue_label</span><span class="p">:</span> <span class="n">BaseDialogueLabel</span><span class="p">,</span>
        <span class="n">self_address</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
        <span class="n">role</span><span class="p">:</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span>
        <span class="n">message_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">LedgerApiMessage</span><span class="p">]</span> <span class="o">=</span> <span class="n">LedgerApiMessage</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a dialogue.</span>

<span class="sd">        :param dialogue_label: the identifier of the dialogue</span>
<span class="sd">        :param self_address: the address of the entity for whom this dialogue is maintained</span>
<span class="sd">        :param role: the role of the agent this dialogue is maintained for</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BaseLedgerApiDialogue</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">dialogue_label</span><span class="o">=</span><span class="n">dialogue_label</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="n">self_address</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="n">role</span><span class="p">,</span>
            <span class="n">message_class</span><span class="o">=</span><span class="n">message_class</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: Optional[FipaDialogue]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">associated_fipa_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FipaDialogue</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get associated_fipa_dialogue.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AEAEnforceError</span><span class="p">(</span><span class="s2">&quot;FipaDialogue not set!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span>

    <span class="nd">@associated_fipa_dialogue</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">associated_fipa_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set associated_fipa_dialogue&quot;&quot;&quot;</span>
        <span class="n">enforce</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;FipaDialogue already set!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span> <span class="o">=</span> <span class="n">fipa_dialogue</span>


<span class="k">class</span> <span class="nc">LedgerApiDialogues</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">BaseLedgerApiDialogues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogues class keeps track of all dialogues.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize dialogues.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Model</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">role_from_first_message</span><span class="p">(</span>  <span class="c1"># pylint: disable=unused-argument</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span> <span class="n">receiver_address</span><span class="p">:</span> <span class="n">Address</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Infer the role of the agent from an incoming/outgoing first message</span>

<span class="sd">            :param message: an incoming/outgoing first message</span>
<span class="sd">            :param receiver_address: the address of the receiving agent</span>
<span class="sd">            :return: The role of the agent</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">BaseLedgerApiDialogue</span><span class="o">.</span><span class="n">Role</span><span class="o">.</span><span class="n">AGENT</span>

        <span class="n">BaseLedgerApiDialogues</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_address</span><span class="p">,</span>
            <span class="n">role_from_first_message</span><span class="o">=</span><span class="n">role_from_first_message</span><span class="p">,</span>
            <span class="n">dialogue_class</span><span class="o">=</span><span class="n">LedgerApiDialogue</span><span class="p">,</span>
        <span class="p">)</span>


<span class="n">OefSearchDialogue</span> <span class="o">=</span> <span class="n">BaseOefSearchDialogue</span>


<span class="k">class</span> <span class="nc">OefSearchDialogues</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">BaseOefSearchDialogues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class keeps track of all oef_search dialogues.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize dialogues.</span>

<span class="sd">        :param agent_address: the address of the agent for whom dialogues are maintained</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Model</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">role_from_first_message</span><span class="p">(</span>  <span class="c1"># pylint: disable=unused-argument</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span> <span class="n">receiver_address</span><span class="p">:</span> <span class="n">Address</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Infer the role of the agent from an incoming/outgoing first message</span>

<span class="sd">            :param message: an incoming/outgoing first message</span>
<span class="sd">            :param receiver_address: the address of the receiving agent</span>
<span class="sd">            :return: The role of the agent</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">BaseOefSearchDialogue</span><span class="o">.</span><span class="n">Role</span><span class="o">.</span><span class="n">AGENT</span>

        <span class="n">BaseOefSearchDialogues</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_address</span><span class="p">,</span>
            <span class="n">role_from_first_message</span><span class="o">=</span><span class="n">role_from_first_message</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
<p>The <code>FipaDialogues</code> class stores dialogue with each <code>my_generic_buyer</code> (and other AEAs) and exposes a number of helpful methods to manage them. This helps us match messages to a dialogue, access previous messages and enable us to identify possible communications problems between the <code>my_generic_seller</code> AEA and the <code>my_generic_buyer</code> AEA. It also keeps track of the data that we offer for sale during the proposal phase.</p>
<p>The <code>FipaDialogues</code> class extends <code>BaseFipaDialogues</code>, which itself derives from the base <a href="../api/helpers/dialogue/base#dialogues-objects"><code>Dialogues</code></a> class. Similarly, the <code>FipaDialogue</code> class extends <code>BaseFipaDialogue</code>, which itself derives from the base <a href="../api/helpers/dialogue/base#dialogue-objects"><code>Dialogue</code></a> class. To learn more about dialogues have a look <a href="../protocol">here</a>.</p>
<h3 id="step-6-update-the-yaml-files">Step 6: Update the YAML files</h3>
<p>Since we made so many changes to our AEA we have to update the <code>skill.yaml</code> (at <code>my_generic_seller/skills/generic_seller/skill.yaml</code>). Make sure that your <code>skill.yaml</code> matches with the following code</p>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generic_seller</span>
<span class="nt">author</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">fetchai</span>
<span class="nt">version</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1.0</span>
<span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">skill</span>
<span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The weather station skill implements the functionality to sell weather</span>
  <span class="l l-Scalar l-Scalar-Plain">data.</span>
<span class="nt">license</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Apache-2.0</span>
<span class="nt">aea_version</span><span class="p">:</span> <span class="s">&#39;&gt;=0.7.0,</span><span class="nv"> </span><span class="s">&lt;0.8.0&#39;</span>
<span class="nt">fingerprint</span><span class="p">:</span>
  <span class="nt">__init__.py</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">QmNkZAetyctaZCUf6ACxP5onGWsSxu2hjSNoFmJ3ta6Lta</span>
  <span class="nt">behaviours.py</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">QmcFahpL4DZ1rsTNEK1BT3e5T8TEJJg2hP4ytkzdqKuJnZ</span>
  <span class="nt">dialogues.py</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">QmRmoFp9xi1p1THVBYym9xEwW88KgkBHgz45LgrYbBecQw</span>
  <span class="nt">handlers.py</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">QmT4nvKikWXfGAEdRS8Qn8w89Gbh5zPb4EDB6EwPVP2YDJ</span>
  <span class="nt">strategy.py</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">QmP69kCtcovLD2Z7quESuNxVEyNuiZgqqbwozp6wAbvBCd</span>
<span class="nt">fingerprint_ignore_patterns</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
<span class="nt">contracts</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
<span class="nt">protocols</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fetchai/default:0.9.0</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fetchai/fipa:0.10.0</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fetchai/ledger_api:0.7.0</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fetchai/oef_search:0.10.0</span>
<span class="nt">skills</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
<span class="nt">behaviours</span><span class="p">:</span>
  <span class="nt">service_registration</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span>
      <span class="nt">services_interval</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">20</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GenericServiceRegistrationBehaviour</span>
<span class="nt">handlers</span><span class="p">:</span>
  <span class="nt">fipa</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GenericFipaHandler</span>
  <span class="nt">ledger_api</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GenericLedgerApiHandler</span>
  <span class="nt">oef_search</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GenericOefSearchHandler</span>
<span class="nt">models</span><span class="p">:</span>
  <span class="nt">default_dialogues</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DefaultDialogues</span>
  <span class="nt">fipa_dialogues</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FipaDialogues</span>
  <span class="nt">ledger_api_dialogues</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">LedgerApiDialogues</span>
  <span class="nt">oef_search_dialogues</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OefSearchDialogues</span>
  <span class="nt">strategy</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span>
      <span class="nt">currency_id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FET</span>
      <span class="nt">data_for_sale</span><span class="p">:</span>
        <span class="nt">generic</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">data</span>
      <span class="nt">has_data_source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
      <span class="nt">is_ledger_tx</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class="nt">ledger_id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">fetchai</span>
      <span class="nt">location</span><span class="p">:</span>
        <span class="nt">latitude</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">51.5194</span>
        <span class="nt">longitude</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.127</span>
      <span class="nt">service_data</span><span class="p">:</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">seller_service</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generic_service</span>
      <span class="nt">service_id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generic_service</span>
      <span class="nt">unit_price</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GenericStrategy</span>
<span class="nt">dependencies</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
</code></pre></div>
<p>We must pay attention to the models and in particular the strategys variables. Here we can change the price we would like to sell each reading for or the currency we would like to transact with. Lastly, the dependencies are the third party packages we need to install in order to get readings from the sensor.</p>
<p>Finally, we fingerprint our new skill:</p>
<div class="highlight"><pre><span></span><code>aea fingerprint skill fetchai/generic_seller:0.1.0
</code></pre></div>
<p>This will hash each file and save the hash in the fingerprint. This way, in the future we can easily track if any of the files have changed.</p>
<h2 id="generic-buyer-aea">Generic Buyer AEA</h2>
<h3 id="step-1-create-the-aea_1">Step 1: Create the AEA</h3>
<p>In a new terminal, create a new AEA by typing the following command in the terminal:</p>
<div class="highlight"><pre><span></span><code>aea create my_generic_buyer
<span class="nb">cd</span> my_generic_buyer
</code></pre></div>
<p>Our newly created AEA is inside the current working directory. Lets create our new skill that will handle the purchase of the data. Type the following command:</p>
<div class="highlight"><pre><span></span><code>aea scaffold skill generic_buyer
</code></pre></div>
<p>This command will create the correct structure for a new skill inside our AEA project You can locate the newly created skill inside the skills folder (<code>my_generic_buyer/skills/generic_buyer/</code>) and it must contain the following files:</p>
<ul>
<li><code>__init__.py</code></li>
<li><code>behaviours.py</code></li>
<li><code>handlers.py</code></li>
<li><code>my_model.py</code></li>
<li><code>skills.yaml</code></li>
</ul>
<h3 id="step-2-create-the-behaviour_1">Step 2: Create the behaviour</h3>
<p>A <a href="../api/skills/base#behaviour-objects"><code>Behaviour</code></a> class contains the business logic specific to actions initiated by the AEA rather than reactions to other events.</p>
<p>Open the <code>behaviours.py</code> (<code>my_generic_buyer/skills/generic_buyer/behaviours.py</code>) and add the following code (replacing the stub code already present in the file):</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">cast</span>

<span class="kn">from</span> <span class="nn">aea.skills.behaviours</span> <span class="kn">import</span> <span class="n">TickerBehaviour</span>

<span class="kn">from</span> <span class="nn">packages.fetchai.connections.ledger.base</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CONNECTION_ID</span> <span class="k">as</span> <span class="n">LEDGER_CONNECTION_PUBLIC_ID</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.ledger_api.message</span> <span class="kn">import</span> <span class="n">LedgerApiMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.oef_search.message</span> <span class="kn">import</span> <span class="n">OefSearchMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.skills.generic_buyer.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">LedgerApiDialogues</span><span class="p">,</span>
    <span class="n">OefSearchDialogues</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.skills.generic_buyer.strategy</span> <span class="kn">import</span> <span class="n">GenericStrategy</span>


<span class="n">DEFAULT_SEARCH_INTERVAL</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">LEDGER_API_ADDRESS</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">LEDGER_CONNECTION_PUBLIC_ID</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">GenericSearchBehaviour</span><span class="p">(</span><span class="n">TickerBehaviour</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class implements a search behaviour.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the search behaviour.&quot;&quot;&quot;</span>
        <span class="n">search_interval</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="nb">float</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;search_interval&quot;</span><span class="p">,</span> <span class="n">DEFAULT_SEARCH_INTERVAL</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tick_interval</span><span class="o">=</span><span class="n">search_interval</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Implement the setup for the behaviour.&quot;&quot;&quot;</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strategy</span><span class="o">.</span><span class="n">is_ledger_tx</span><span class="p">:</span>
            <span class="n">ledger_api_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">LedgerApiDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">ledger_api_dialogues</span>
            <span class="p">)</span>
            <span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ledger_api_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">counterparty</span><span class="o">=</span><span class="n">LEDGER_API_ADDRESS</span><span class="p">,</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">GET_BALANCE</span><span class="p">,</span>
                <span class="n">ledger_id</span><span class="o">=</span><span class="n">strategy</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">,</span>
                <span class="n">address</span><span class="o">=</span><span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_addresses</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">strategy</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">)),</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">ledger_api_msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">strategy</span><span class="o">.</span><span class="n">is_searching</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">act</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the act.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strategy</span><span class="o">.</span><span class="n">is_searching</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get_location_and_service_query</span><span class="p">()</span>
            <span class="n">oef_search_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">OefSearchDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">oef_search_dialogues</span>
            <span class="p">)</span>
            <span class="n">oef_search_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">oef_search_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">counterparty</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">search_service_address</span><span class="p">,</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">SEARCH_SERVICES</span><span class="p">,</span>
                <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">oef_search_msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the task teardown.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div>
<p>This <a href="../api/skills/behaviours#tickerbehaviour-objects"><code>TickerBehaviour</code></a> will search on  the <a href="../simple-oef">SOEF search node</a> with a specific query at regular tick intervals.</p>
<h3 id="step-3-create-the-handler_1">Step 3: Create the handler</h3>
<p>So far, we have tasked the AEA with sending search queries to the <a href="../simple-oef">SOEF search node</a>. However, we have at present no way of handling the responses sent to the AEA by the <a href="../simple-oef">SOEF search node</a> or messages sent by other agent.</p>
<p>Let us now implement a <a href="../api/skills/base#handler-objects"><code>Handler</code></a> to deal with the incoming messages. Open the <code>handlers.py</code> file (<code>my_generic_buyer/skills/generic_buyer/handlers.py</code>) and add the following code (replacing the stub code already present in the file):</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">cast</span>

<span class="kn">from</span> <span class="nn">aea.configurations.base</span> <span class="kn">import</span> <span class="n">PublicId</span>
<span class="kn">from</span> <span class="nn">aea.protocols.base</span> <span class="kn">import</span> <span class="n">Message</span>
<span class="kn">from</span> <span class="nn">aea.skills.base</span> <span class="kn">import</span> <span class="n">Handler</span>

<span class="kn">from</span> <span class="nn">packages.fetchai.connections.ledger.base</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CONNECTION_ID</span> <span class="k">as</span> <span class="n">LEDGER_CONNECTION_PUBLIC_ID</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.default.message</span> <span class="kn">import</span> <span class="n">DefaultMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.fipa.message</span> <span class="kn">import</span> <span class="n">FipaMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.ledger_api.message</span> <span class="kn">import</span> <span class="n">LedgerApiMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.oef_search.message</span> <span class="kn">import</span> <span class="n">OefSearchMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.signing.message</span> <span class="kn">import</span> <span class="n">SigningMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.skills.generic_buyer.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DefaultDialogues</span><span class="p">,</span>
    <span class="n">FipaDialogue</span><span class="p">,</span>
    <span class="n">FipaDialogues</span><span class="p">,</span>
    <span class="n">LedgerApiDialogue</span><span class="p">,</span>
    <span class="n">LedgerApiDialogues</span><span class="p">,</span>
    <span class="n">OefSearchDialogue</span><span class="p">,</span>
    <span class="n">OefSearchDialogues</span><span class="p">,</span>
    <span class="n">SigningDialogue</span><span class="p">,</span>
    <span class="n">SigningDialogues</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.skills.generic_buyer.strategy</span> <span class="kn">import</span> <span class="n">GenericStrategy</span>


<span class="n">LEDGER_API_ADDRESS</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">LEDGER_CONNECTION_PUBLIC_ID</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">GenericFipaHandler</span><span class="p">(</span><span class="n">Handler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class implements a FIPA handler.&quot;&quot;&quot;</span>

    <span class="n">SUPPORTED_PROTOCOL</span> <span class="o">=</span> <span class="n">FipaMessage</span><span class="o">.</span><span class="n">protocol_id</span>  <span class="c1"># type: Optional[PublicId]</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the setup.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the reaction to a message.</span>

<span class="sd">        :param message: the message</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fipa_msg</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">FipaMessage</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

        <span class="c1"># recover dialogue</span>
        <span class="n">fipa_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">FipaDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fipa_dialogues</span><span class="p">)</span>
        <span class="n">fipa_dialogue</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">FipaDialogue</span><span class="p">,</span> <span class="n">fipa_dialogues</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">fipa_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_unidentified_dialogue</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># handle message</span>
        <span class="k">if</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">performative</span> <span class="o">==</span> <span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">PROPOSE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_propose</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">performative</span> <span class="o">==</span> <span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">DECLINE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_decline</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">,</span> <span class="n">fipa_dialogues</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">performative</span> <span class="o">==</span> <span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">MATCH_ACCEPT_W_INFORM</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_match_accept</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">performative</span> <span class="o">==</span> <span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">INFORM</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_inform</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">,</span> <span class="n">fipa_dialogues</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_invalid</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the handler teardown.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div>
You will see that we are following similar logic to the <code>generic_seller</code> when we develop the <code>generic_buyer</code>s side of the negotiation. First, we create a new dialogue and we store it in the dialogues class. Then we are checking what kind of message we received. So lets start creating our handlers:</p>
<p><div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">_handle_unidentified_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="p">:</span> <span class="n">FipaMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an unidentified dialogue.</span>

<span class="sd">        :param fipa_msg: the message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received invalid fipa message=</span><span class="si">{}</span><span class="s2">, unidentified dialogue.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">default_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">DefaultDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">default_dialogues</span><span class="p">)</span>
        <span class="n">default_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">default_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">counterparty</span><span class="o">=</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span>
            <span class="n">performative</span><span class="o">=</span><span class="n">DefaultMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
            <span class="n">error_code</span><span class="o">=</span><span class="n">DefaultMessage</span><span class="o">.</span><span class="n">ErrorCode</span><span class="o">.</span><span class="n">INVALID_DIALOGUE</span><span class="p">,</span>
            <span class="n">error_msg</span><span class="o">=</span><span class="s2">&quot;Invalid dialogue.&quot;</span><span class="p">,</span>
            <span class="n">error_data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fipa_message&quot;</span><span class="p">:</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">encode</span><span class="p">()},</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">default_msg</span><span class="p">)</span>
</code></pre></div>
The above code handles the unidentified dialogues. And responds with an error message to the sender. Next we will handle the <code>PROPOSE</code> message that we receive from the <code>my_generic_seller</code> AEA:</p>
<p><div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">_handle_propose</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="p">:</span> <span class="n">FipaMessage</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the propose.</span>

<span class="sd">        :param fipa_msg: the message</span>
<span class="sd">        :param fipa_dialogue: the dialogue object</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received proposal=</span><span class="si">{}</span><span class="s2"> from sender=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">fipa_msg</span><span class="o">.</span><span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:],</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="n">acceptable</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">is_acceptable_proposal</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">proposal</span><span class="p">)</span>
        <span class="n">affordable</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">is_affordable_proposal</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">proposal</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">acceptable</span> <span class="ow">and</span> <span class="n">affordable</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;accepting the proposal from sender=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
            <span class="p">)</span>
            <span class="n">terms</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">terms_from_proposal</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">proposal</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">)</span>
            <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">terms</span> <span class="o">=</span> <span class="n">terms</span>
            <span class="n">accept_msg</span> <span class="o">=</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">ACCEPT</span><span class="p">,</span> <span class="n">target_message</span><span class="o">=</span><span class="n">fipa_msg</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">accept_msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;declining the proposal from sender=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
            <span class="p">)</span>
            <span class="n">decline_msg</span> <span class="o">=</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">DECLINE</span><span class="p">,</span> <span class="n">target_message</span><span class="o">=</span><span class="n">fipa_msg</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">decline_msg</span><span class="p">)</span>
</code></pre></div>
When we receive a proposal we have to check if we have the funds to complete the transaction and if the proposal is acceptable based on our strategy. If the proposal is not affordable or acceptable we respond with a <code>DECLINE</code> message. Otherwise, we send an <code>ACCEPT</code> message to the seller.</p>
<p>The next code-block handles the <code>DECLINE</code> message that we may receive from the buyer on our <code>CFP</code>message or our <code>ACCEPT</code> message:</p>
<p><div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">_handle_decline</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fipa_msg</span><span class="p">:</span> <span class="n">FipaMessage</span><span class="p">,</span>
        <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span><span class="p">,</span>
        <span class="n">fipa_dialogues</span><span class="p">:</span> <span class="n">FipaDialogues</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the decline.</span>

<span class="sd">        :param fipa_msg: the message</span>
<span class="sd">        :param fipa_dialogue: the fipa dialogue</span>
<span class="sd">        :param fipa_dialogues: the fipa dialogues</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received DECLINE from sender=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">target</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fipa_dialogues</span><span class="o">.</span><span class="n">dialogue_stats</span><span class="o">.</span><span class="n">add_dialogue_endstate</span><span class="p">(</span>
                <span class="n">FipaDialogue</span><span class="o">.</span><span class="n">EndState</span><span class="o">.</span><span class="n">DECLINED_CFP</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">is_self_initiated</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">target</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">fipa_dialogues</span><span class="o">.</span><span class="n">dialogue_stats</span><span class="o">.</span><span class="n">add_dialogue_endstate</span><span class="p">(</span>
                <span class="n">FipaDialogue</span><span class="o">.</span><span class="n">EndState</span><span class="o">.</span><span class="n">DECLINED_ACCEPT</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">is_self_initiated</span>
            <span class="p">)</span>
</code></pre></div>
The above code terminates each dialogue with the specific AEA and stores the step. For example, if the <code>target == 1</code> we know that the seller declined our <code>CFP</code> message.</p>
<p>In case we do not receive any <code>DECLINE</code> message that means that the <code>my_generic_seller</code> AEA want to move on with the sale, in that case, it will send a <code>MATCH_ACCEPT</code> message. In order to handle this we add the following code:</p>
<p><div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">_handle_match_accept</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="p">:</span> <span class="n">FipaMessage</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the match accept.</span>

<span class="sd">        :param fipa_msg: the message</span>
<span class="sd">        :param fipa_dialogue: the dialogue object</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received MATCH_ACCEPT_W_INFORM from sender=</span><span class="si">{}</span><span class="s2"> with info=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:],</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">info</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strategy</span><span class="o">.</span><span class="n">is_ledger_tx</span><span class="p">:</span>
            <span class="n">transfer_address</span> <span class="o">=</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;address&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">transfer_address</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transfer_address</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">terms</span><span class="o">.</span><span class="n">counterparty_address</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># pragma: nocover</span>
                    <span class="n">transfer_address</span>
                <span class="p">)</span>
            <span class="n">ledger_api_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">LedgerApiDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">ledger_api_dialogues</span>
            <span class="p">)</span>
            <span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span> <span class="o">=</span> <span class="n">ledger_api_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">counterparty</span><span class="o">=</span><span class="n">LEDGER_API_ADDRESS</span><span class="p">,</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">GET_RAW_TRANSACTION</span><span class="p">,</span>
                <span class="n">terms</span><span class="o">=</span><span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">terms</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ledger_api_dialogue</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">LedgerApiDialogue</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">)</span>
            <span class="n">ledger_api_dialogue</span><span class="o">.</span><span class="n">associated_fipa_dialogue</span> <span class="o">=</span> <span class="n">fipa_dialogue</span>
            <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">associated_ledger_api_dialogue</span> <span class="o">=</span> <span class="n">ledger_api_dialogue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">ledger_api_msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;requesting transfer transaction from ledger api...&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inform_msg</span> <span class="o">=</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">INFORM</span><span class="p">,</span>
                <span class="n">target_message</span><span class="o">=</span><span class="n">fipa_msg</span><span class="p">,</span>
                <span class="n">info</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Done&quot;</span><span class="p">:</span> <span class="s2">&quot;Sending payment via bank transfer&quot;</span><span class="p">},</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">inform_msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;informing counterparty=</span><span class="si">{}</span><span class="s2"> of payment.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
            <span class="p">)</span>
</code></pre></div>
The first thing we are checking is if we enabled our AEA to transact with a ledger. If we can transact with a ledger we generate a <code>LedgerApiMessage</code> of performative <code>GET_RAW_TRANSACTION</code> and send it to the ledger connection. The ledger connection will construct a raw transaction for us, using the relevant ledger api.</p>
<p>Lastly, we need to handle the <code>INFORM</code> message. This is the message that will have our data:</p>
<p><div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">_handle_inform</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fipa_msg</span><span class="p">:</span> <span class="n">FipaMessage</span><span class="p">,</span>
        <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span><span class="p">,</span>
        <span class="n">fipa_dialogues</span><span class="p">:</span> <span class="n">FipaDialogues</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the match inform.</span>

<span class="sd">        :param fipa_msg: the message</span>
<span class="sd">        :param fipa_dialogue: the fipa dialogue</span>
<span class="sd">        :param fipa_dialogues: the fipa dialogues</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received INFORM from sender=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">fipa_msg</span><span class="o">.</span><span class="n">info</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;received the following data=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pprint</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">fipa_dialogues</span><span class="o">.</span><span class="n">dialogue_stats</span><span class="o">.</span><span class="n">add_dialogue_endstate</span><span class="p">(</span>
                <span class="n">FipaDialogue</span><span class="o">.</span><span class="n">EndState</span><span class="o">.</span><span class="n">SUCCESSFUL</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">is_self_initiated</span>
            <span class="p">)</span>
            <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
            <span class="n">strategy</span><span class="o">.</span><span class="n">successful_trade_with_counterparty</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;received no data from sender=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fipa_msg</span><span class="o">.</span><span class="n">sender</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_invalid</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">fipa_msg</span><span class="p">:</span> <span class="n">FipaMessage</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle a fipa message of invalid performative.</span>

<span class="sd">        :param fipa_msg: the message</span>
<span class="sd">        :param fipa_dialogue: the fipa dialogue</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;cannot handle fipa message of performative=</span><span class="si">{}</span><span class="s2"> in dialogue=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">fipa_msg</span><span class="o">.</span><span class="n">performative</span><span class="p">,</span> <span class="n">fipa_dialogue</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
The main difference between the <code>generic_buyer</code> and the <code>generic_seller</code> skill <code>handlers.py</code> file is that in this one we create more than one handler.</p>
<p>The reason is that we receive messages not only from the <code>my_generic_seller</code> AEA but also from the <code>DecisionMaker</code> and the <a href="../simple-oef">SOEF search node</a>. We need one handler for each type of protocol we use.</p>
<p>To handle the messages in the <code>oef_search</code> protocol used by the <a href="../simple-oef">SOEF search node</a> we add the following code in the same file (<code>my_generic_buyer/skills/generic_buyer/handlers.py</code>):</p>
<p><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GenericOefSearchHandler</span><span class="p">(</span><span class="n">Handler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class implements an OEF search handler.&quot;&quot;&quot;</span>

    <span class="n">SUPPORTED_PROTOCOL</span> <span class="o">=</span> <span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">protocol_id</span>  <span class="c1"># type: Optional[PublicId]</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call to setup the handler.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the reaction to a message.</span>

<span class="sd">        :param message: the message</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oef_search_msg</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">OefSearchMessage</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

        <span class="c1"># recover dialogue</span>
        <span class="n">oef_search_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">OefSearchDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">oef_search_dialogues</span>
        <span class="p">)</span>
        <span class="n">oef_search_dialogue</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">Optional</span><span class="p">[</span><span class="n">OefSearchDialogue</span><span class="p">],</span> <span class="n">oef_search_dialogues</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">oef_search_msg</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">oef_search_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_unidentified_dialogue</span><span class="p">(</span><span class="n">oef_search_msg</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># handle message</span>
        <span class="k">if</span> <span class="n">oef_search_msg</span><span class="o">.</span><span class="n">performative</span> <span class="ow">is</span> <span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">OEF_ERROR</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_error</span><span class="p">(</span><span class="n">oef_search_msg</span><span class="p">,</span> <span class="n">oef_search_dialogue</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">oef_search_msg</span><span class="o">.</span><span class="n">performative</span> <span class="ow">is</span> <span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">SEARCH_RESULT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_search</span><span class="p">(</span><span class="n">oef_search_msg</span><span class="p">,</span> <span class="n">oef_search_dialogue</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_invalid</span><span class="p">(</span><span class="n">oef_search_msg</span><span class="p">,</span> <span class="n">oef_search_dialogue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the handler teardown.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_handle_unidentified_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oef_search_msg</span><span class="p">:</span> <span class="n">OefSearchMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an unidentified dialogue.</span>

<span class="sd">        :param msg: the message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received invalid oef_search message=</span><span class="si">{}</span><span class="s2">, unidentified dialogue.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">oef_search_msg</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_error</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">oef_search_msg</span><span class="p">:</span> <span class="n">OefSearchMessage</span><span class="p">,</span> <span class="n">oef_search_dialogue</span><span class="p">:</span> <span class="n">OefSearchDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an oef search message.</span>

<span class="sd">        :param oef_search_msg: the oef search message</span>
<span class="sd">        :param oef_search_dialogue: the dialogue</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received oef_search error message=</span><span class="si">{}</span><span class="s2"> in dialogue=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">oef_search_msg</span><span class="p">,</span> <span class="n">oef_search_dialogue</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_search</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">oef_search_msg</span><span class="p">:</span> <span class="n">OefSearchMessage</span><span class="p">,</span> <span class="n">oef_search_dialogue</span><span class="p">:</span> <span class="n">OefSearchDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the search response.</span>

<span class="sd">        :param agents: the agents returned by the search</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">oef_search_msg</span><span class="o">.</span><span class="n">agents</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;found no agents in dialogue=</span><span class="si">{</span><span class="n">oef_search_dialogue</span><span class="si">}</span><span class="s2">, continue searching.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strategy</span><span class="o">.</span><span class="n">is_stop_searching_on_result</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;found agents=</span><span class="si">{}</span><span class="s2">, stopping search.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:],</span> <span class="n">oef_search_msg</span><span class="o">.</span><span class="n">agents</span><span class="p">)),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">strategy</span><span class="o">.</span><span class="n">is_searching</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># stopping search</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;found agents=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:],</span> <span class="n">oef_search_msg</span><span class="o">.</span><span class="n">agents</span><span class="p">)),</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="n">query</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get_service_query</span><span class="p">()</span>
        <span class="n">fipa_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">FipaDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">fipa_dialogues</span><span class="p">)</span>
        <span class="n">counterparties</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get_acceptable_counterparties</span><span class="p">(</span><span class="n">oef_search_msg</span><span class="o">.</span><span class="n">agents</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">counterparty</span> <span class="ow">in</span> <span class="n">counterparties</span><span class="p">:</span>
            <span class="n">cfp_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">fipa_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">counterparty</span><span class="o">=</span><span class="n">counterparty</span><span class="p">,</span>
                <span class="n">performative</span><span class="o">=</span><span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">CFP</span><span class="p">,</span>
                <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">cfp_msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;sending CFP to agent=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">counterparty</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_invalid</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">oef_search_msg</span><span class="p">:</span> <span class="n">OefSearchMessage</span><span class="p">,</span> <span class="n">oef_search_dialogue</span><span class="p">:</span> <span class="n">OefSearchDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an oef search message.</span>

<span class="sd">        :param oef_search_msg: the oef search message</span>
<span class="sd">        :param oef_search_dialogue: the dialogue</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;cannot handle oef_search message of performative=</span><span class="si">{}</span><span class="s2"> in dialogue=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">oef_search_msg</span><span class="o">.</span><span class="n">performative</span><span class="p">,</span> <span class="n">oef_search_dialogue</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
When we receive a message from the <a href="../simple-oef">SOEF search node</a> of a type <code>OefSearchMessage.Performative.SEARCH_RESULT</code>, we are passing the details to the relevant handler method. In the <code>_handle_search</code> function we are checking that the response contains some agents and we stop the search if it does. We pick our first agent and we send a <code>CFP</code> message.</p>
<p>The last handlers we need are the <code>GenericSigningHandler</code> and the <code>GenericLedgerApiHandler</code>. This handler will handle the <code>SigningMessages</code> that we receive from the <code>DecisionMaker</code>. The <code>GenericLedgerApiHandler</code> will handle the <code>LedgerApiMessages</code> that we receive from the ledger connection.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GenericSigningHandler</span><span class="p">(</span><span class="n">Handler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implement the signing handler.&quot;&quot;&quot;</span>

    <span class="n">SUPPORTED_PROTOCOL</span> <span class="o">=</span> <span class="n">SigningMessage</span><span class="o">.</span><span class="n">protocol_id</span>  <span class="c1"># type: Optional[PublicId]</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Implement the setup for the handler.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the reaction to a message.</span>

<span class="sd">        :param message: the message</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">signing_msg</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">SigningMessage</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

        <span class="c1"># recover dialogue</span>
        <span class="n">signing_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">SigningDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">signing_dialogues</span><span class="p">)</span>
        <span class="n">signing_dialogue</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">Optional</span><span class="p">[</span><span class="n">SigningDialogue</span><span class="p">],</span> <span class="n">signing_dialogues</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">signing_msg</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">signing_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_unidentified_dialogue</span><span class="p">(</span><span class="n">signing_msg</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># handle message</span>
        <span class="k">if</span> <span class="n">signing_msg</span><span class="o">.</span><span class="n">performative</span> <span class="ow">is</span> <span class="n">SigningMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">SIGNED_TRANSACTION</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_signed_transaction</span><span class="p">(</span><span class="n">signing_msg</span><span class="p">,</span> <span class="n">signing_dialogue</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">signing_msg</span><span class="o">.</span><span class="n">performative</span> <span class="ow">is</span> <span class="n">SigningMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">ERROR</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_error</span><span class="p">(</span><span class="n">signing_msg</span><span class="p">,</span> <span class="n">signing_dialogue</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_invalid</span><span class="p">(</span><span class="n">signing_msg</span><span class="p">,</span> <span class="n">signing_dialogue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the handler teardown.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_handle_unidentified_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signing_msg</span><span class="p">:</span> <span class="n">SigningMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an unidentified dialogue.</span>

<span class="sd">        :param msg: the message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received invalid signing message=</span><span class="si">{}</span><span class="s2">, unidentified dialogue.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">signing_msg</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_signed_transaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">signing_msg</span><span class="p">:</span> <span class="n">SigningMessage</span><span class="p">,</span> <span class="n">signing_dialogue</span><span class="p">:</span> <span class="n">SigningDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an oef search message.</span>

<span class="sd">        :param signing_msg: the signing message</span>
<span class="sd">        :param signing_dialogue: the dialogue</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;transaction signing was successful.&quot;</span><span class="p">)</span>
        <span class="n">fipa_dialogue</span> <span class="o">=</span> <span class="n">signing_dialogue</span><span class="o">.</span><span class="n">associated_fipa_dialogue</span>
        <span class="n">ledger_api_dialogue</span> <span class="o">=</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">associated_ledger_api_dialogue</span>
        <span class="n">last_ledger_api_msg</span> <span class="o">=</span> <span class="n">ledger_api_dialogue</span><span class="o">.</span><span class="n">last_incoming_message</span>
        <span class="k">if</span> <span class="n">last_ledger_api_msg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not retrieve last message in ledger api dialogue&quot;</span><span class="p">)</span>
        <span class="n">ledger_api_msg</span> <span class="o">=</span> <span class="n">ledger_api_dialogue</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span>
            <span class="n">performative</span><span class="o">=</span><span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">SEND_SIGNED_TRANSACTION</span><span class="p">,</span>
            <span class="n">target_message</span><span class="o">=</span><span class="n">last_ledger_api_msg</span><span class="p">,</span>
            <span class="n">signed_transaction</span><span class="o">=</span><span class="n">signing_msg</span><span class="o">.</span><span class="n">signed_transaction</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">ledger_api_msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;sending transaction to ledger.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_error</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">signing_msg</span><span class="p">:</span> <span class="n">SigningMessage</span><span class="p">,</span> <span class="n">signing_dialogue</span><span class="p">:</span> <span class="n">SigningDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an oef search message.</span>

<span class="sd">        :param signing_msg: the signing message</span>
<span class="sd">        :param signing_dialogue: the dialogue</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;transaction signing was not successful. Error_code=</span><span class="si">{}</span><span class="s2"> in dialogue=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">signing_msg</span><span class="o">.</span><span class="n">error_code</span><span class="p">,</span> <span class="n">signing_dialogue</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_invalid</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">signing_msg</span><span class="p">:</span> <span class="n">SigningMessage</span><span class="p">,</span> <span class="n">signing_dialogue</span><span class="p">:</span> <span class="n">SigningDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an oef search message.</span>

<span class="sd">        :param signing_msg: the signing message</span>
<span class="sd">        :param signing_dialogue: the dialogue</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;cannot handle signing message of performative=</span><span class="si">{}</span><span class="s2"> in dialogue=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">signing_msg</span><span class="o">.</span><span class="n">performative</span><span class="p">,</span> <span class="n">signing_dialogue</span>
            <span class="p">)</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">GenericLedgerApiHandler</span><span class="p">(</span><span class="n">Handler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implement the ledger handler.&quot;&quot;&quot;</span>

    <span class="n">SUPPORTED_PROTOCOL</span> <span class="o">=</span> <span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">protocol_id</span>  <span class="c1"># type: Optional[PublicId]</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Implement the setup for the handler.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the reaction to a message.</span>

<span class="sd">        :param message: the message</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ledger_api_msg</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">LedgerApiMessage</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

        <span class="c1"># recover dialogue</span>
        <span class="n">ledger_api_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">LedgerApiDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">ledger_api_dialogues</span>
        <span class="p">)</span>
        <span class="n">ledger_api_dialogue</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">Optional</span><span class="p">[</span><span class="n">LedgerApiDialogue</span><span class="p">],</span> <span class="n">ledger_api_dialogues</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">ledger_api_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_unidentified_dialogue</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># handle message</span>
        <span class="k">if</span> <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">performative</span> <span class="ow">is</span> <span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">BALANCE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_balance</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">performative</span> <span class="ow">is</span> <span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">RAW_TRANSACTION</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_raw_transaction</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">performative</span>
            <span class="o">==</span> <span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">TRANSACTION_DIGEST</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_transaction_digest</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">performative</span> <span class="o">==</span> <span class="n">LedgerApiMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">ERROR</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_error</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handle_invalid</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement the handler teardown.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_handle_unidentified_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="p">:</span> <span class="n">LedgerApiMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle an unidentified dialogue.</span>

<span class="sd">        :param msg: the message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received invalid ledger_api message=</span><span class="si">{}</span><span class="s2">, unidentified dialogue.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">ledger_api_msg</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="p">:</span> <span class="n">LedgerApiMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle a message of balance performative.</span>

<span class="sd">        :param ledger_api_message: the ledger api message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">GenericStrategy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">strategy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">balance</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;starting balance on </span><span class="si">{}</span><span class="s2"> ledger=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">strategy</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">strategy</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">balance</span>
            <span class="n">strategy</span><span class="o">.</span><span class="n">is_searching</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;you have no starting balance on </span><span class="si">{}</span><span class="s2"> ledger!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">strategy</span><span class="o">.</span><span class="n">ledger_id</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">is_active</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_handle_raw_transaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="p">:</span> <span class="n">LedgerApiMessage</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">:</span> <span class="n">LedgerApiDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle a message of raw_transaction performative.</span>

<span class="sd">        :param ledger_api_message: the ledger api message</span>
<span class="sd">        :param ledger_api_dialogue: the ledger api dialogue</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;received raw transaction=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ledger_api_msg</span><span class="p">))</span>
        <span class="n">signing_dialogues</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">SigningDialogues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">signing_dialogues</span><span class="p">)</span>
        <span class="n">signing_msg</span><span class="p">,</span> <span class="n">signing_dialogue</span> <span class="o">=</span> <span class="n">signing_dialogues</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">counterparty</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">decision_maker_address</span><span class="p">,</span>
            <span class="n">performative</span><span class="o">=</span><span class="n">SigningMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">SIGN_TRANSACTION</span><span class="p">,</span>
            <span class="n">raw_transaction</span><span class="o">=</span><span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">raw_transaction</span><span class="p">,</span>
            <span class="n">terms</span><span class="o">=</span><span class="n">ledger_api_dialogue</span><span class="o">.</span><span class="n">associated_fipa_dialogue</span><span class="o">.</span><span class="n">terms</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">signing_dialogue</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">SigningDialogue</span><span class="p">,</span> <span class="n">signing_dialogue</span><span class="p">)</span>
        <span class="n">signing_dialogue</span><span class="o">.</span><span class="n">associated_fipa_dialogue</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ledger_api_dialogue</span><span class="o">.</span><span class="n">associated_fipa_dialogue</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">decision_maker_message_queue</span><span class="o">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">signing_msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;proposing the transaction to the decision maker. Waiting for confirmation ...&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_transaction_digest</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="p">:</span> <span class="n">LedgerApiMessage</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">:</span> <span class="n">LedgerApiDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle a message of transaction_digest performative.</span>

<span class="sd">        :param ledger_api_message: the ledger api message</span>
<span class="sd">        :param ledger_api_dialogue: the ledger api dialogue</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fipa_dialogue</span> <span class="o">=</span> <span class="n">ledger_api_dialogue</span><span class="o">.</span><span class="n">associated_fipa_dialogue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;transaction was successfully submitted. Transaction digest=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">transaction_digest</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">fipa_msg</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Optional</span><span class="p">[</span><span class="n">FipaMessage</span><span class="p">],</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">last_incoming_message</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fipa_msg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not retrieve fipa message&quot;</span><span class="p">)</span>
        <span class="n">inform_msg</span> <span class="o">=</span> <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">reply</span><span class="p">(</span>
            <span class="n">performative</span><span class="o">=</span><span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">INFORM</span><span class="p">,</span>
            <span class="n">target_message</span><span class="o">=</span><span class="n">fipa_msg</span><span class="p">,</span>
            <span class="n">info</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;transaction_digest&quot;</span><span class="p">:</span> <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">transaction_digest</span><span class="o">.</span><span class="n">body</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">inform_msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;informing counterparty=</span><span class="si">{}</span><span class="s2"> of transaction digest.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">fipa_dialogue</span><span class="o">.</span><span class="n">dialogue_label</span><span class="o">.</span><span class="n">dialogue_opponent_addr</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:],</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_error</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="p">:</span> <span class="n">LedgerApiMessage</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">:</span> <span class="n">LedgerApiDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle a message of error performative.</span>

<span class="sd">        :param ledger_api_message: the ledger api message</span>
<span class="sd">        :param ledger_api_dialogue: the ledger api dialogue</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;received ledger_api error message=</span><span class="si">{}</span><span class="s2"> in dialogue=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">ledger_api_msg</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_invalid</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ledger_api_msg</span><span class="p">:</span> <span class="n">LedgerApiMessage</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">:</span> <span class="n">LedgerApiDialogue</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle a message of invalid performative.</span>

<span class="sd">        :param ledger_api_message: the ledger api message</span>
<span class="sd">        :param ledger_api_dialogue: the ledger api dialogue</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;cannot handle ledger_api message of performative=</span><span class="si">{}</span><span class="s2"> in dialogue=</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">ledger_api_msg</span><span class="o">.</span><span class="n">performative</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
<h3 id="step-4-create-the-strategy_1">Step 4: Create the strategy</h3>
<p>We are going to create the strategy that we want our AEA to follow. Rename the <code>my_model.py</code> file (in <code>my_generic_buyer/skills/generic_buyer/</code>) to <code>strategy.py</code> and paste the following code (replacing the stub code already present in the file):</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">aea.common</span> <span class="kn">import</span> <span class="n">Address</span>
<span class="kn">from</span> <span class="nn">aea.exceptions</span> <span class="kn">import</span> <span class="n">enforce</span>
<span class="kn">from</span> <span class="nn">aea.helpers.search.generic</span> <span class="kn">import</span> <span class="n">SIMPLE_SERVICE_MODEL</span>
<span class="kn">from</span> <span class="nn">aea.helpers.search.models</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Constraint</span><span class="p">,</span>
    <span class="n">ConstraintType</span><span class="p">,</span>
    <span class="n">Description</span><span class="p">,</span>
    <span class="n">Location</span><span class="p">,</span>
    <span class="n">Query</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">aea.helpers.transaction.base</span> <span class="kn">import</span> <span class="n">Terms</span>
<span class="kn">from</span> <span class="nn">aea.skills.base</span> <span class="kn">import</span> <span class="n">Model</span>


<span class="n">DEFAULT_IS_LEDGER_TX</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">DEFAULT_MAX_UNIT_PRICE</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">DEFAULT_MAX_TX_FEE</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">DEFAULT_SERVICE_ID</span> <span class="o">=</span> <span class="s2">&quot;generic_service&quot;</span>

<span class="n">DEFAULT_LOCATION</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="mf">0.1270</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="mf">51.5194</span><span class="p">}</span>
<span class="n">DEFAULT_SEARCH_QUERY</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;search_key&quot;</span><span class="p">:</span> <span class="s2">&quot;seller_service&quot;</span><span class="p">,</span>
    <span class="s2">&quot;search_value&quot;</span><span class="p">:</span> <span class="s2">&quot;generic_service&quot;</span><span class="p">,</span>
    <span class="s2">&quot;constraint_type&quot;</span><span class="p">:</span> <span class="s2">&quot;==&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">DEFAULT_SEARCH_RADIUS</span> <span class="o">=</span> <span class="mf">5.0</span>

<span class="n">DEFAULT_MAX_NEGOTIATIONS</span> <span class="o">=</span> <span class="mi">2</span>


<span class="k">class</span> <span class="nc">GenericStrategy</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class defines a strategy for the agent.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the strategy of the agent.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ledger_id</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ledger_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">currency_id</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;currency_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_ledger_tx</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;is_ledger_tx&quot;</span><span class="p">,</span> <span class="n">DEFAULT_IS_LEDGER_TX</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_max_unit_price</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;max_unit_price&quot;</span><span class="p">,</span> <span class="n">DEFAULT_MAX_UNIT_PRICE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_tx_fee</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;max_tx_fee&quot;</span><span class="p">,</span> <span class="n">DEFAULT_MAX_TX_FEE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_service_id</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;service_id&quot;</span><span class="p">,</span> <span class="n">DEFAULT_SERVICE_ID</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_search_query</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;search_query&quot;</span><span class="p">,</span> <span class="n">DEFAULT_SEARCH_QUERY</span><span class="p">)</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="n">DEFAULT_LOCATION</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_agent_location</span> <span class="o">=</span> <span class="n">Location</span><span class="p">(</span>
            <span class="n">latitude</span><span class="o">=</span><span class="n">location</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">longitude</span><span class="o">=</span><span class="n">location</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;search_radius&quot;</span><span class="p">,</span> <span class="n">DEFAULT_SEARCH_RADIUS</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_max_negotiations</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span>
            <span class="s2">&quot;max_negotiations&quot;</span><span class="p">,</span> <span class="n">DEFAULT_MAX_NEGOTIATIONS</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_stop_searching_on_result</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;stop_searching_on_result&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ledger_id</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ledger_id</span> <span class="k">if</span> <span class="n">ledger_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">default_ledger_id</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">currency_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">currency_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">currency_denominations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ledger_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">enforce</span><span class="p">(</span>
                <span class="n">currency_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;Currency denomination for ledger_id=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ledger_id</span><span class="si">}</span><span class="s2"> not specified.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currency_id</span> <span class="o">=</span> <span class="n">currency_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_searching</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_balance</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>
<p>We initialize the strategy class by trying to read the strategy variables from the YAML file. If this is not possible we specified some default values. The following two methods are related to the oef search service, add them under the initialization of the class:</p>
<div class="highlight"><pre><span></span><code>    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ledger_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the ledger id.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ledger_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_ledger_tx</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Check whether or not tx are settled on a ledger.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_ledger_tx</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_stop_searching_on_result</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Check if search is stopped on result.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_stop_searching_on_result</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_searching</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Check if the agent is searching.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_searching</span>

    <span class="nd">@is_searching</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">is_searching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_searching</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Check if the agent is searching.&quot;&quot;&quot;</span>
        <span class="n">enforce</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">is_searching</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s2">&quot;Can only set bool on is_searching!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_searching</span> <span class="o">=</span> <span class="n">is_searching</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">balance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the balance.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_balance</span>

    <span class="nd">@balance</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">balance</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the balance.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_balance</span> <span class="o">=</span> <span class="n">balance</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_negotiations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the maximum number of negotiations the agent can start.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_negotiations</span>

    <span class="k">def</span> <span class="nf">get_location_and_service_query</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Query</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the location and service query of the agent.</span>

<span class="sd">        :return: the query</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">close_to_my_service</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span>
            <span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="n">ConstraintType</span><span class="p">(</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_agent_location</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">service_key_filter</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_search_query</span><span class="p">[</span><span class="s2">&quot;search_key&quot;</span><span class="p">],</span>
            <span class="n">ConstraintType</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_search_query</span><span class="p">[</span><span class="s2">&quot;constraint_type&quot;</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_search_query</span><span class="p">[</span><span class="s2">&quot;search_value&quot;</span><span class="p">],</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">([</span><span class="n">close_to_my_service</span><span class="p">,</span> <span class="n">service_key_filter</span><span class="p">],)</span>
        <span class="k">return</span> <span class="n">query</span>

    <span class="k">def</span> <span class="nf">get_service_query</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Query</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the service query of the agent.</span>

<span class="sd">        :return: the query</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service_key_filter</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_search_query</span><span class="p">[</span><span class="s2">&quot;search_key&quot;</span><span class="p">],</span>
            <span class="n">ConstraintType</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_search_query</span><span class="p">[</span><span class="s2">&quot;constraint_type&quot;</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_search_query</span><span class="p">[</span><span class="s2">&quot;search_value&quot;</span><span class="p">],</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">([</span><span class="n">service_key_filter</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="n">SIMPLE_SERVICE_MODEL</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">query</span>
</code></pre></div>
<p>The following code block checks if the proposal that we received is acceptable based on the strategy:</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">is_acceptable_proposal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proposal</span><span class="p">:</span> <span class="n">Description</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether it is an acceptable proposal.</span>

<span class="sd">        :return: whether it is acceptable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">all</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">key</span> <span class="ow">in</span> <span class="n">proposal</span><span class="o">.</span><span class="n">values</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
                        <span class="s2">&quot;ledger_id&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;currency_id&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;price&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;service_id&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;quantity&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;tx_nonce&quot;</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="ow">and</span> <span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;ledger_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger_id</span>
            <span class="ow">and</span> <span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>
            <span class="o">&lt;=</span> <span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_unit_price</span>
            <span class="ow">and</span> <span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;currency_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currency_id</span>
            <span class="ow">and</span> <span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;service_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_service_id</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;tx_nonce&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;tx_nonce&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
<p>The <code>is_affordable_proposal</code> method checks if we can afford the transaction based on the funds we have in our wallet on the ledger.</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">is_affordable_proposal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proposal</span><span class="p">:</span> <span class="n">Description</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether it is an affordable proposal.</span>

<span class="sd">        :return: whether it is affordable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ledger_tx</span><span class="p">:</span>
            <span class="n">payable</span> <span class="o">=</span> <span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_tx_fee</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">&gt;=</span> <span class="n">payable</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">get_acceptable_counterparties</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">counterparties</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Process counterparties and drop unacceptable ones.</span>

<span class="sd">        :return: list of counterparties</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">valid_counterparties</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">counterparty</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">counterparties</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_negotiations</span><span class="p">:</span>
                <span class="n">valid_counterparties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">counterparty</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">valid_counterparties</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">terms_from_proposal</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">proposal</span><span class="p">:</span> <span class="n">Description</span><span class="p">,</span> <span class="n">counterparty_address</span><span class="p">:</span> <span class="n">Address</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Terms</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the terms from a proposal.</span>

<span class="sd">        :param proposal: the proposal</span>
<span class="sd">        :return: terms</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">buyer_address</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_addresses</span><span class="p">[</span><span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;ledger_id&quot;</span><span class="p">]]</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="n">Terms</span><span class="p">(</span>
            <span class="n">ledger_id</span><span class="o">=</span><span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;ledger_id&quot;</span><span class="p">],</span>
            <span class="n">sender_address</span><span class="o">=</span><span class="n">buyer_address</span><span class="p">,</span>
            <span class="n">counterparty_address</span><span class="o">=</span><span class="n">counterparty_address</span><span class="p">,</span>
            <span class="n">amount_by_currency_id</span><span class="o">=</span><span class="p">{</span>
                <span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;currency_id&quot;</span><span class="p">]:</span> <span class="o">-</span><span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="n">quantities_by_good_id</span><span class="o">=</span><span class="p">{</span>
                <span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;service_id&quot;</span><span class="p">]:</span> <span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="n">is_sender_payable_tx_fee</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">nonce</span><span class="o">=</span><span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;tx_nonce&quot;</span><span class="p">],</span>
            <span class="n">fee_by_currency_id</span><span class="o">=</span><span class="p">{</span><span class="n">proposal</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;currency_id&quot;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_tx_fee</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">terms</span>

    <span class="k">def</span> <span class="nf">successful_trade_with_counterparty</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">counterparty</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Do something on successful trade.</span>

<span class="sd">        :param counterparty: the counterparty address</span>
<span class="sd">        :param data: the data</span>
<span class="sd">        :return: False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div>
<h3 id="step-5-create-the-dialogues_1">Step 5: Create the dialogues</h3>
<p>As mentioned, when we are negotiating with other AEA we would like to keep track of these negotiations for various reasons. Create a new file and name it <code>dialogues.py</code> (in <code>my_generic_buyer/skills/generic_buyer/</code>). Inside this file add the following code:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Type</span>

<span class="kn">from</span> <span class="nn">aea.common</span> <span class="kn">import</span> <span class="n">Address</span>
<span class="kn">from</span> <span class="nn">aea.exceptions</span> <span class="kn">import</span> <span class="n">AEAEnforceError</span><span class="p">,</span> <span class="n">enforce</span>
<span class="kn">from</span> <span class="nn">aea.helpers.transaction.base</span> <span class="kn">import</span> <span class="n">Terms</span>
<span class="kn">from</span> <span class="nn">aea.protocols.base</span> <span class="kn">import</span> <span class="n">Message</span>
<span class="kn">from</span> <span class="nn">aea.protocols.dialogue.base</span> <span class="kn">import</span> <span class="n">Dialogue</span> <span class="k">as</span> <span class="n">BaseDialogue</span>
<span class="kn">from</span> <span class="nn">aea.protocols.dialogue.base</span> <span class="kn">import</span> <span class="n">DialogueLabel</span> <span class="k">as</span> <span class="n">BaseDialogueLabel</span>
<span class="kn">from</span> <span class="nn">aea.skills.base</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.default.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DefaultDialogue</span> <span class="k">as</span> <span class="n">BaseDefaultDialogue</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.default.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DefaultDialogues</span> <span class="k">as</span> <span class="n">BaseDefaultDialogues</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.fipa.dialogues</span> <span class="kn">import</span> <span class="n">FipaDialogue</span> <span class="k">as</span> <span class="n">BaseFipaDialogue</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.fipa.dialogues</span> <span class="kn">import</span> <span class="n">FipaDialogues</span> <span class="k">as</span> <span class="n">BaseFipaDialogues</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.fipa.message</span> <span class="kn">import</span> <span class="n">FipaMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.ledger_api.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">LedgerApiDialogue</span> <span class="k">as</span> <span class="n">BaseLedgerApiDialogue</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.ledger_api.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">LedgerApiDialogues</span> <span class="k">as</span> <span class="n">BaseLedgerApiDialogues</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.ledger_api.message</span> <span class="kn">import</span> <span class="n">LedgerApiMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.oef_search.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">OefSearchDialogue</span> <span class="k">as</span> <span class="n">BaseOefSearchDialogue</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.oef_search.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">OefSearchDialogues</span> <span class="k">as</span> <span class="n">BaseOefSearchDialogues</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.signing.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SigningDialogue</span> <span class="k">as</span> <span class="n">BaseSigningDialogue</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.signing.dialogues</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SigningDialogues</span> <span class="k">as</span> <span class="n">BaseSigningDialogues</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.signing.message</span> <span class="kn">import</span> <span class="n">SigningMessage</span>


<span class="n">DefaultDialogue</span> <span class="o">=</span> <span class="n">BaseDefaultDialogue</span>


<span class="k">class</span> <span class="nc">DefaultDialogues</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">BaseDefaultDialogues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogues class keeps track of all dialogues.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize dialogues.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Model</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">role_from_first_message</span><span class="p">(</span>  <span class="c1"># pylint: disable=unused-argument</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span> <span class="n">receiver_address</span><span class="p">:</span> <span class="n">Address</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Infer the role of the agent from an incoming/outgoing first message</span>

<span class="sd">            :param message: an incoming/outgoing first message</span>
<span class="sd">            :param receiver_address: the address of the receiving agent</span>
<span class="sd">            :return: The role of the agent</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">DefaultDialogue</span><span class="o">.</span><span class="n">Role</span><span class="o">.</span><span class="n">AGENT</span>

        <span class="n">BaseDefaultDialogues</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_address</span><span class="p">,</span>
            <span class="n">role_from_first_message</span><span class="o">=</span><span class="n">role_from_first_message</span><span class="p">,</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">FipaDialogue</span><span class="p">(</span><span class="n">BaseFipaDialogue</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogue class maintains state of a dialogue and manages it.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dialogue_label</span><span class="p">:</span> <span class="n">BaseDialogueLabel</span><span class="p">,</span>
        <span class="n">self_address</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
        <span class="n">role</span><span class="p">:</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span>
        <span class="n">message_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">FipaMessage</span><span class="p">]</span> <span class="o">=</span> <span class="n">FipaMessage</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a dialogue.</span>

<span class="sd">        :param dialogue_label: the identifier of the dialogue</span>
<span class="sd">        :param self_address: the address of the entity for whom this dialogue is maintained</span>
<span class="sd">        :param role: the role of the agent this dialogue is maintained for</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BaseFipaDialogue</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">dialogue_label</span><span class="o">=</span><span class="n">dialogue_label</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="n">self_address</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="n">role</span><span class="p">,</span>
            <span class="n">message_class</span><span class="o">=</span><span class="n">message_class</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_terms</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: Optional[Terms]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_associated_ledger_api_dialogue</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: Optional[LedgerApiDialogue]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">terms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Terms</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get terms.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_terms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AEAEnforceError</span><span class="p">(</span><span class="s2">&quot;Terms not set!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_terms</span>

    <span class="nd">@terms</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">terms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">terms</span><span class="p">:</span> <span class="n">Terms</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set terms.&quot;&quot;&quot;</span>
        <span class="n">enforce</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_terms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Terms already set!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_terms</span> <span class="o">=</span> <span class="n">terms</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">associated_ledger_api_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LedgerApiDialogue&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get associated_ledger_api_dialogue.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associated_ledger_api_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AEAEnforceError</span><span class="p">(</span><span class="s2">&quot;LedgerApiDialogue not set!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associated_ledger_api_dialogue</span>

    <span class="nd">@associated_ledger_api_dialogue</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">associated_ledger_api_dialogue</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ledger_api_dialogue</span><span class="p">:</span> <span class="s2">&quot;LedgerApiDialogue&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set associated_ledger_api_dialogue&quot;&quot;&quot;</span>
        <span class="n">enforce</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_associated_ledger_api_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;LedgerApiDialogue already set!&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_associated_ledger_api_dialogue</span> <span class="o">=</span> <span class="n">ledger_api_dialogue</span>


<span class="k">class</span> <span class="nc">FipaDialogues</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">BaseFipaDialogues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogues class keeps track of all dialogues.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize dialogues.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Model</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">role_from_first_message</span><span class="p">(</span>  <span class="c1"># pylint: disable=unused-argument</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span> <span class="n">receiver_address</span><span class="p">:</span> <span class="n">Address</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Infer the role of the agent from an incoming/outgoing first message</span>

<span class="sd">            :param message: an incoming/outgoing first message</span>
<span class="sd">            :param receiver_address: the address of the receiving agent</span>
<span class="sd">            :return: The role of the agent</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">BaseFipaDialogue</span><span class="o">.</span><span class="n">Role</span><span class="o">.</span><span class="n">BUYER</span>

        <span class="n">BaseFipaDialogues</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_address</span><span class="p">,</span>
            <span class="n">role_from_first_message</span><span class="o">=</span><span class="n">role_from_first_message</span><span class="p">,</span>
            <span class="n">dialogue_class</span><span class="o">=</span><span class="n">FipaDialogue</span><span class="p">,</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">LedgerApiDialogue</span><span class="p">(</span><span class="n">BaseLedgerApiDialogue</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogue class maintains state of a dialogue and manages it.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dialogue_label</span><span class="p">:</span> <span class="n">BaseDialogueLabel</span><span class="p">,</span>
        <span class="n">self_address</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
        <span class="n">role</span><span class="p">:</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span>
        <span class="n">message_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">LedgerApiMessage</span><span class="p">]</span> <span class="o">=</span> <span class="n">LedgerApiMessage</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a dialogue.</span>

<span class="sd">        :param dialogue_label: the identifier of the dialogue</span>
<span class="sd">        :param self_address: the address of the entity for whom this dialogue is maintained</span>
<span class="sd">        :param role: the role of the agent this dialogue is maintained for</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BaseLedgerApiDialogue</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">dialogue_label</span><span class="o">=</span><span class="n">dialogue_label</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="n">self_address</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="n">role</span><span class="p">,</span>
            <span class="n">message_class</span><span class="o">=</span><span class="n">message_class</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: Optional[FipaDialogue]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">associated_fipa_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FipaDialogue</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get associated_fipa_dialogue.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AEAEnforceError</span><span class="p">(</span><span class="s2">&quot;FipaDialogue not set!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span>

    <span class="nd">@associated_fipa_dialogue</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">associated_fipa_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set associated_fipa_dialogue&quot;&quot;&quot;</span>
        <span class="n">enforce</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;FipaDialogue already set!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span> <span class="o">=</span> <span class="n">fipa_dialogue</span>


<span class="k">class</span> <span class="nc">LedgerApiDialogues</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">BaseLedgerApiDialogues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogues class keeps track of all dialogues.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize dialogues.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Model</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">role_from_first_message</span><span class="p">(</span>  <span class="c1"># pylint: disable=unused-argument</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span> <span class="n">receiver_address</span><span class="p">:</span> <span class="n">Address</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Infer the role of the agent from an incoming/outgoing first message</span>

<span class="sd">            :param message: an incoming/outgoing first message</span>
<span class="sd">            :param receiver_address: the address of the receiving agent</span>
<span class="sd">            :return: The role of the agent</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">BaseLedgerApiDialogue</span><span class="o">.</span><span class="n">Role</span><span class="o">.</span><span class="n">AGENT</span>

        <span class="n">BaseLedgerApiDialogues</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_address</span><span class="p">,</span>
            <span class="n">role_from_first_message</span><span class="o">=</span><span class="n">role_from_first_message</span><span class="p">,</span>
            <span class="n">dialogue_class</span><span class="o">=</span><span class="n">LedgerApiDialogue</span><span class="p">,</span>
        <span class="p">)</span>


<span class="n">OefSearchDialogue</span> <span class="o">=</span> <span class="n">BaseOefSearchDialogue</span>


<span class="k">class</span> <span class="nc">OefSearchDialogues</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">BaseOefSearchDialogues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class keeps track of all oef_search dialogues.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize dialogues.</span>

<span class="sd">        :param agent_address: the address of the agent for whom dialogues are maintained</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Model</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">role_from_first_message</span><span class="p">(</span>  <span class="c1"># pylint: disable=unused-argument</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span> <span class="n">receiver_address</span><span class="p">:</span> <span class="n">Address</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Infer the role of the agent from an incoming/outgoing first message</span>

<span class="sd">            :param message: an incoming/outgoing first message</span>
<span class="sd">            :param receiver_address: the address of the receiving agent</span>
<span class="sd">            :return: The role of the agent</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">BaseOefSearchDialogue</span><span class="o">.</span><span class="n">Role</span><span class="o">.</span><span class="n">AGENT</span>

        <span class="n">BaseOefSearchDialogues</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_address</span><span class="p">,</span>
            <span class="n">role_from_first_message</span><span class="o">=</span><span class="n">role_from_first_message</span><span class="p">,</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">SigningDialogue</span><span class="p">(</span><span class="n">BaseSigningDialogue</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogue class maintains state of a dialogue and manages it.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dialogue_label</span><span class="p">:</span> <span class="n">BaseDialogueLabel</span><span class="p">,</span>
        <span class="n">self_address</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
        <span class="n">role</span><span class="p">:</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span>
        <span class="n">message_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">SigningMessage</span><span class="p">]</span> <span class="o">=</span> <span class="n">SigningMessage</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a dialogue.</span>

<span class="sd">        :param dialogue_label: the identifier of the dialogue</span>
<span class="sd">        :param self_address: the address of the entity for whom this dialogue is maintained</span>
<span class="sd">        :param role: the role of the agent this dialogue is maintained for</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BaseSigningDialogue</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">dialogue_label</span><span class="o">=</span><span class="n">dialogue_label</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="n">self_address</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="n">role</span><span class="p">,</span>
            <span class="n">message_class</span><span class="o">=</span><span class="n">message_class</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: Optional[FipaDialogue]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">associated_fipa_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FipaDialogue</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get associated_fipa_dialogue.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AEAEnforceError</span><span class="p">(</span><span class="s2">&quot;FipaDialogue not set!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span>

    <span class="nd">@associated_fipa_dialogue</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">associated_fipa_dialogue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fipa_dialogue</span><span class="p">:</span> <span class="n">FipaDialogue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set associated_fipa_dialogue&quot;&quot;&quot;</span>
        <span class="n">enforce</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;FipaDialogue already set!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_associated_fipa_dialogue</span> <span class="o">=</span> <span class="n">fipa_dialogue</span>


<span class="k">class</span> <span class="nc">SigningDialogues</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">BaseSigningDialogues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class keeps track of all oef_search dialogues.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize dialogues.</span>

<span class="sd">        :param agent_address: the address of the agent for whom dialogues are maintained</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Model</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">role_from_first_message</span><span class="p">(</span>  <span class="c1"># pylint: disable=unused-argument</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span> <span class="n">receiver_address</span><span class="p">:</span> <span class="n">Address</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Infer the role of the agent from an incoming/outgoing first message</span>

<span class="sd">            :param message: an incoming/outgoing first message</span>
<span class="sd">            :param receiver_address: the address of the receiving agent</span>
<span class="sd">            :return: The role of the agent</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">BaseSigningDialogue</span><span class="o">.</span><span class="n">Role</span><span class="o">.</span><span class="n">SKILL</span>

        <span class="n">BaseSigningDialogues</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skill_id</span><span class="p">),</span>
            <span class="n">role_from_first_message</span><span class="o">=</span><span class="n">role_from_first_message</span><span class="p">,</span>
            <span class="n">dialogue_class</span><span class="o">=</span><span class="n">SigningDialogue</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
<p>The dialogues class stores dialogue with each AEA and other AEA components so we can have access to previous messages and enable us to identify possible communications problems between the <code>my_generic_seller</code> AEA and the <code>my_generic_buyer</code> AEA.</p>
<h3 id="step-6-update-the-yaml-files_1">Step 6: Update the YAML files</h3>
<p>Since we made so many changes to our AEA we have to update the <code>skill.yaml</code> to contain our newly created scripts and the details that will be used from the strategy.</p>
<p>First, we update the <code>skill.yaml</code>. Make sure that your <code>skill.yaml</code> matches with the following code:</p>
<p><div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generic_buyer</span>
<span class="nt">author</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">fetchai</span>
<span class="nt">version</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1.0</span>
<span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">skill</span>
<span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The weather client skill implements the skill to purchase weather data.</span>
<span class="nt">license</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Apache-2.0</span>
<span class="nt">aea_version</span><span class="p">:</span> <span class="s">&#39;&gt;=0.7.0,</span><span class="nv"> </span><span class="s">&lt;0.8.0&#39;</span>
<span class="nt">fingerprint</span><span class="p">:</span>
  <span class="nt">__init__.py</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">QmNkZAetyctaZCUf6ACxP5onGWsSxu2hjSNoFmJ3ta6Lta</span>
  <span class="nt">behaviours.py</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">QmUBQvZkoCcik71vqRZGP4JJBgFP2kj8o7C24dfkAphitP</span>
  <span class="nt">dialogues.py</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Qmf3McwyT5wMv3BzoN1L3ssqZzEq19LShEjQueiKqvADcX</span>
  <span class="nt">handlers.py</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">QmQVmi3GnuYJ5VM4trYjUeJyFHVfrUeMGDsRmtNCuntKA8</span>
  <span class="nt">strategy.py</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">QmQHQsjAsPiox5zMtMHhdhhhHt4rKq3cs3bqnwjgGSFp6n</span>
<span class="nt">fingerprint_ignore_patterns</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
<span class="nt">contracts</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
<span class="nt">protocols</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fetchai/default:0.9.0</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fetchai/fipa:0.10.0</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fetchai/ledger_api:0.7.0</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fetchai/oef_search:0.10.0</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fetchai/signing:0.7.0</span>
<span class="nt">skills</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
<span class="nt">behaviours</span><span class="p">:</span>
  <span class="nt">search</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span>
      <span class="nt">search_interval</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GenericSearchBehaviour</span>
<span class="nt">handlers</span><span class="p">:</span>
  <span class="nt">fipa</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GenericFipaHandler</span>
  <span class="nt">ledger_api</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GenericLedgerApiHandler</span>
  <span class="nt">oef_search</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GenericOefSearchHandler</span>
  <span class="nt">signing</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GenericSigningHandler</span>
<span class="nt">models</span><span class="p">:</span>
  <span class="nt">default_dialogues</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DefaultDialogues</span>
  <span class="nt">fipa_dialogues</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FipaDialogues</span>
  <span class="nt">ledger_api_dialogues</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">LedgerApiDialogues</span>
  <span class="nt">oef_search_dialogues</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OefSearchDialogues</span>
  <span class="nt">signing_dialogues</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SigningDialogues</span>
  <span class="nt">strategy</span><span class="p">:</span>
    <span class="nt">args</span><span class="p">:</span>
      <span class="nt">currency_id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FET</span>
      <span class="nt">is_ledger_tx</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class="nt">ledger_id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">fetchai</span>
      <span class="nt">location</span><span class="p">:</span>
        <span class="nt">latitude</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">51.5194</span>
        <span class="nt">longitude</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.127</span>
      <span class="nt">max_negotiations</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="nt">max_tx_fee</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="nt">max_unit_price</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">20</span>
      <span class="nt">search_query</span><span class="p">:</span>
        <span class="nt">constraint_type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">==</span>
        <span class="nt">search_key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">seller_service</span>
        <span class="nt">search_value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generic_service</span>
      <span class="nt">search_radius</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5.0</span>
      <span class="nt">service_id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generic_service</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GenericStrategy</span>
<span class="nt">dependencies</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
</code></pre></div>
We must pay attention to the models and the strategys variables. Here we can change the price we would like to buy each reading at or the currency we would like to transact with.</p>
<p>Finally, we fingerprint our new skill:</p>
<div class="highlight"><pre><span></span><code>aea fingerprint skill fetchai/generic_buyer:0.1.0
</code></pre></div>
<p>This will hash each file and save the hash in the fingerprint. This way, in the future we can easily track if any of the files have changed.</p>
<h2 id="run-the-aeas">Run the AEAs</h2>
<!-- <details><summary>Additional steps for Raspberry Pi only!</summary>

<div class="admonition note">
  <p class="admonition-title">Note</p>
  <p>If you are using the Raspberry Pi, make sure that your thermometer sensor is connected to the Raspberry Pi's USB port.</p>
</div>

You can change the end-point's address and port by modifying the connection's yaml file (`*vendor/fetchai/connections/oef/connection.yaml`)

Under config locate:

<div class="highlight"><pre><span></span><code><span class="nt">addr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${OEF_ADDR</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">127.0.0.1}</span>
</code></pre></div>
and replace it with your IP (the IP of the machine that runs the <a href="../oef-ledger">OEF search and communication node</a> image.)

</details> -->

<h3 id="create-private-keys">Create private keys</h3>
<p>Create the private key for each AEA:</p>
<div class="highlight"><pre><span></span><code>aea generate-key fetchai
aea add-key fetchai fetchai_private_key.txt
aea add-key fetchai fetchai_private_key.txt --connection
</code></pre></div>
<h3 id="update-the-aea-configs">Update the AEA configs</h3>
<p>Both in <code>my_generic_seller/aea-config.yaml</code> and <code>my_generic_buyer/aea-config.yaml</code>, and
<div class="highlight"><pre><span></span><code><span class="nt">default_routing</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">fetchai/ledger_api:0.7.0</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">fetchai/ledger:0.10.0</span>
  <span class="l l-Scalar l-Scalar-Plain">fetchai/oef_search:0.10.0</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">fetchai/soef:0.13.0</span>
</code></pre></div></p>
<h3 id="fund-the-buyer-aea">Fund the buyer AEA</h3>
<p>Create some wealth for your buyer on the Fetch.ai testnet. (It takes a while).</p>
<div class="highlight"><pre><span></span><code>aea generate-wealth fetchai --sync
</code></pre></div>
<h3 id="run-seller-aea">Run seller AEA</h3>
<p>Add the remaining packages for the seller AEA, then run it:</p>
<div class="highlight"><pre><span></span><code>aea add connection fetchai/p2p_libp2p:0.12.0
aea add connection fetchai/soef:0.13.0
aea add connection fetchai/ledger:0.10.0
aea add protocol fetchai/fipa:0.10.0
aea install
aea config <span class="nb">set</span> agent.default_connection fetchai/p2p_libp2p:0.12.0
aea run
</code></pre></div>
<p>Once you see a message of the form <code>To join its network use multiaddr: ['SOME_ADDRESS']</code> take note of the address.</p>
<h4 id="run-buyer-aea">Run buyer AEA</h4>
<p>Add the remaining packages for the buyer AEA:</p>
<div class="highlight"><pre><span></span><code>aea add connection fetchai/p2p_libp2p:0.12.0
aea add connection fetchai/soef:0.13.0
aea add connection fetchai/ledger:0.10.0
aea add protocol fetchai/fipa:0.10.0
aea add protocol fetchai/signing:0.7.0
aea install
aea config <span class="nb">set</span> agent.default_connection fetchai/p2p_libp2p:0.12.0
</code></pre></div>
<p>Then, update the configuration of the buyer AEA's p2p connection (in <code>vendor/fetchai/connections/p2p_libp2p/connection.yaml</code>) replace the following:</p>
<div class="highlight"><pre><span></span><code><span class="nt">config</span><span class="p">:</span>
  <span class="nt">delegate_uri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">127.0.0.1:11001</span>
  <span class="nt">entry_peers</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;SOME_ADDRESS&#39;</span><span class="p p-Indicator">]</span>
  <span class="nt">local_uri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">127.0.0.1:9001</span>
  <span class="nt">log_file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">libp2p_node.log</span>
  <span class="nt">public_uri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">127.0.0.1:9001</span>
</code></pre></div>
<p>where <code>SOME_ADDRESS</code> is replaced accordingly.</p>
<p>Then run the buyer AEA:
<div class="highlight"><pre><span></span><code>aea run
</code></pre></div></p>
<p>You will see that the AEAs negotiate and then transact using the Agentland testnet.</p>
<h2 id="delete-the-aeas">Delete the AEAs</h2>
<p>When you are done, go up a level and delete the AEAs.
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> ..
aea delete my_generic_seller
aea delete my_generic_buyer
</code></pre></div></p>
<h2 id="next-steps">Next steps</h2>
<p>You have completed the "Getting Started" series. Congratulations!</p>
<h3 id="recommended">Recommended</h3>
<p>We recommend you build your own AEA next. There are many helpful guides on here and a developer community on <a href="https://fetch-ai.slack.com" target="_blank">Slack</a>. Speak to you there!</p>
<p><br /></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        <footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../core-components-2/" title="Core components - Part 2" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Core components - Part 2
              </span>
            </div>
          </a>
        
        
          <a href="../step-one/" title="Ways to build an AEA" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Ways to build an AEA
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://fetch.ai/" target=_blank>Fetch.AI &copy 2020</a>
        and the
        <a href="https://github.com/fetchai/docs/" target=_blank>
          Fetch.AI Documentation Suite</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.fd16492e.min.js"></script>
      <script src="../../assets/javascripts/bundle.7836ba4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script>
      
    
  </body>
</html>